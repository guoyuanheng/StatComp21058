<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>A—21058-2021-09-16</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">A—21058-2021-09-16</h1>



<div id="question" class="section level1">
<h1>Question</h1>
<p>Use knitr to produce at least 3 examples (texts, figures, tables)</p>
</div>
<div id="answer" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">a&lt;-<span class="st">&quot;hello world&quot;</span></a>
<a class="sourceLine" id="cb1-2" title="2">a</a></code></pre></div>
<pre><code>## [1] &quot;hello world&quot;</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">substr</span>(a,<span class="dv">7</span>,<span class="dv">11</span>)</a></code></pre></div>
<pre><code>## [1] &quot;world&quot;</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">aa&lt;-<span class="kw">c</span>(<span class="st">&quot;hello&quot;</span>,<span class="st">&quot;world&quot;</span>)</a>
<a class="sourceLine" id="cb5-2" title="2">aa</a></code></pre></div>
<pre><code>## [1] &quot;hello&quot; &quot;world&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">aa[<span class="dv">1</span>]</a></code></pre></div>
<pre><code>## [1] &quot;hello&quot;</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">b&lt;-<span class="kw">rnorm</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="kw">sort</span>(b),<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAATlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmAGZmtv+QOgCQZgCQ2/+2ZgC2/7a2///bkDrb////tmb/25D//7b//9v///+Lu18gAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAG70lEQVR4nO2d7WKiOBhGmWp36m67w9ai9f5vdPkQtJXkgZCQ13rOj46aQOKZ8BJCiMUJvBS5K2AdBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEGCyIKKuyGXoLi7SweCBAgSIMhJcfV3cvbIpVum+PLP5PxLS519cshGHkGpdhef4tu/kzeIXL5ZECRAkABBAgT5KW5eTN4icgWMgiABggQIEiBIgCA/xciryZtEroFFitGXk7eJXAV7FI7XkzfS7IuieG1fPL1H2N26FOkF7X/9OR1329P9CboZqkoi6PPtpf27+bg3QbfVSiLouGsPr1O5+fgmyPqI4kqCuhZUU27vqwWN1CpRDDprOe4KBI2y785hdVtCUBgmBY1VCkFXIEiAIAGC/IzWCUEXECSIJag6Xyy8Rq9MXsarNFdQ3Tfedq8+31y95PDaZCWKoOM/106+votQm5w4akQM6kGQH1eFQgTVcagoNh9J6pONiIKq9vzVjKomqE8m3AN48wX1o2HlojZkS5CnNvMF9eOpVchJ3uaQq68yIS2o6wjtf0wL8v5vBcWg5hirfkIMmtCY53YUd5eDZEE/Or+gycf5w/WD5obARxM0u9wHuxabX+xDXc2H9C4eaTwoqMwHikFhRQb0pP/uOkBBPen55cZgSd89XJBrWkLkcpez7LJmrqDy0lF8WaXcBUVEueoLb0ErlZu7hPDhjpXKDdh11OGC8OGOlcqdu9/YAykh/aAJ0bnuRfovaOMLSjTMFNKC9NX8vo/glSuUR/8myZpkigpchSnXsFrE75N2iDKJoKswVSWe5Zp88DZE0OG5rpZvQHG1FrTC0HbwkOved7E6JKaNQWt0x8P7Qd5B+z6SO/NE+G7r3BlZ+bbP/HIT7iFuMfNaULxyXduvdbWbJgZFLPf7dmvfd0xyFotZ7mWLPDdk72ZE0fxtkIyCst7LDxB03L00j1wumyA0485d3puwAYLKzcfheXsqtyuXm4ewflAzh2qdflBuP4GCylrOKoP2+ecRhRxi2+Nu89E91Jy43Ox6AoN03Qnqp1ElK9fKNDSjp3kTblpsCjKjx6YgO83ntLqgKUOulvRYbEG2/CBIYU6QMT8IUhgTZOoE1mJLkDk9CJKYEmTQD4IUlgRZ9IMgRSJBIesomvSTSFDQOooPJChsHcUHEuReR9G3uwcSFLSOok0/qWJQwDqKDyXIuY6iY0TRyi2MEUz0g4y6aUkpyPdUx/XurDaeFgOCLOuxIMi2HwQpsgsy7if3Wcx0fG7JK8i8ntyC7gAECRAkQJAgm6C7IZOgSfsU6Xk3X5g9yj4RtCwdQQhalo4gBC1LRxCClqX/fEE/CgQJECRAkABBAgQJECRAkABBAgQJECRAkABBguiCKvcqVu1KsC/eTN1PLzmSmyWytu7Nh8cAPFWYT2xBzU/fOH7+5vOt/nzffEVnpqpdvsiRXNVp7Tz/8fTmMYD2J8A8VQggsqBu7tD4GkSH5/YHzJ7enZmOu0aQI7n72Ll5t+pI/amvCgFEFjRIcOao/2+dmfabf2tBjuTDX398ZQyCdBVmEVtQ+y18izSVT++uTPXnTQxyJFdP/+3aEOZI7w8xXYVZRBbUHfueCNCs1ujI1BwbjSBH8r6Z3d+0E1cZ59gsqzCPlQVVfYweM1DL8Qn6dW4ZjvRm+azDs1N/KOseYt1qn+OZ2k89h1gXVeoI49i8Dz22DzF/hDwv+T6eaX+el/Lq2Ef3leuvP54+NBzbQdp7jr08CuPMVLpP893TapXrNN95cSYHs2JHsQkQKlPp6Sjue3nj6X0Mst1RbI8UR+XOx1CT6szUXWo4kqv+SmU8vfQnB8LFqgBBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJLAo6/H6/eTNM7Y06x3cCBgUdd1dze85vhhkbcaduTMCeoLqJXASd3wxzfiJP/pmAOUFV8VJ1TraXN5f5dXGnj03AnKDTt/mFnaB+3mHkCYgTuA9BwwTEyFNYJ4AgwX0I4hD7wogggvQ1t4I4zX/hVhAdxS9c+kGnwdYwtTfqHN8JWBRkCgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkOB/iccQDbnfV8MAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">c&lt;-<span class="kw">table</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb10-2" title="2">c</a></code></pre></div>
<pre><code>## 
## 1 2 3 4 5 6 
## 2 2 2 2 2 1</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">set.seed</span>(<span class="dv">2021917</span>)</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">matrix</span>(<span class="kw">rexp</span>(<span class="dv">9</span>),<span class="dt">nrow =</span> <span class="dv">3</span>,<span class="dt">ncol =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##            [,1]      [,2]      [,3]
## [1,] 0.03165167 2.8175000 2.0963544
## [2,] 0.32027598 0.3947838 0.2152053
## [3,] 1.45222534 0.2584574 0.3313859</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">d&lt;-<span class="kw">data.frame</span>(<span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb14-2" title="2"></a>
<a class="sourceLine" id="cb14-3" title="3">d[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">2</span>]</a></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div id="question-3.4" class="section level1">
<h1>Question 3.4</h1>
<p>Develop an algorithm to generate random samples from a Rayleigh(σ) distri- bution. Generate Rayleigh(σ) samples for several choices of σ &gt; 0 and check that the mode of the generated samples is close to the theoretical mode σ (check the histogram).</p>
</div>
<div id="answer-1" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb16-2" title="2">sigma=<span class="fl">0.1</span></a>
<a class="sourceLine" id="cb16-3" title="3">u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb16-4" title="4">x &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))</a>
<a class="sourceLine" id="cb16-5" title="5"><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))))</a>
<a class="sourceLine" id="cb16-6" title="6">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">0.4</span>, <span class="fl">.01</span>)</a>
<a class="sourceLine" id="cb16-7" title="7"><span class="kw">lines</span>(y, y<span class="op">/</span>sigma<span class="op">/</span>sigma<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span>sigma<span class="op">/</span>sigma),<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb16-8" title="8"><span class="kw">legend</span>(<span class="fl">0.3</span>,<span class="dv">3</span>,<span class="dt">legend=</span><span class="st">&quot;sigma=0.1&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb17-2" title="2">sigma=<span class="fl">0.3</span></a>
<a class="sourceLine" id="cb17-3" title="3">u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb17-4" title="4">x &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))</a>
<a class="sourceLine" id="cb17-5" title="5"><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))))</a>
<a class="sourceLine" id="cb17-6" title="6">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">1.4</span>, <span class="fl">.01</span>)</a>
<a class="sourceLine" id="cb17-7" title="7"><span class="kw">lines</span>(y, y<span class="op">/</span>sigma<span class="op">/</span>sigma<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span>sigma<span class="op">/</span>sigma),<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb17-8" title="8"><span class="kw">legend</span>(<span class="fl">0.8</span>,<span class="fl">1.5</span>,<span class="dt">legend=</span><span class="st">&quot;sigma=0.3&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb18-2" title="2">sigma=<span class="dv">2</span></a>
<a class="sourceLine" id="cb18-3" title="3">u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb18-4" title="4">x &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))</a>
<a class="sourceLine" id="cb18-5" title="5"><span class="kw">hist</span>(x,<span class="dt">breaks =</span> <span class="dv">15</span>, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))))</a>
<a class="sourceLine" id="cb18-6" title="6">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="fl">.001</span>)</a>
<a class="sourceLine" id="cb18-7" title="7"><span class="kw">lines</span>(y, y<span class="op">/</span>sigma<span class="op">/</span>sigma<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span>sigma<span class="op">/</span>sigma),<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-8" title="8"><span class="kw">legend</span>(<span class="dv">6</span>,<span class="fl">0.1</span>,<span class="dt">legend=</span><span class="st">&quot;sigma=2&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3.11" class="section level1">
<h1>Question 3.11</h1>
<p>Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have N(0,1) and N(3,1) distributions with mixing probabilities p 1 and p 2 = 1 − p 1 . Graph the histogram of the sample with density superimposed, for p 1 = 0.75. Repeat with different values for p 1 and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of p 1 that produce bimodal mixtures.</p>
</div>
<div id="answer-2" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb19-2" title="2">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n) </a>
<a class="sourceLine" id="cb19-3" title="3">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dt">mean =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb19-4" title="4">p1=<span class="fl">0.75</span></a>
<a class="sourceLine" id="cb19-5" title="5">p2=<span class="fl">0.25</span></a>
<a class="sourceLine" id="cb19-6" title="6">xx&lt;-<span class="kw">sample</span>(x,<span class="dt">size =</span> n<span class="op">*</span>p1)</a>
<a class="sourceLine" id="cb19-7" title="7">yy&lt;-<span class="kw">sample</span>(y,<span class="dt">size =</span> n<span class="op">*</span>p2)</a>
<a class="sourceLine" id="cb19-8" title="8">a&lt;-<span class="kw">c</span>(xx,yy)</a>
<a class="sourceLine" id="cb19-9" title="9"><span class="kw">hist</span>(a)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb20-2" title="2">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n) </a>
<a class="sourceLine" id="cb20-3" title="3">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dt">mean =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb20-4" title="4">p1=<span class="fl">0.25</span></a>
<a class="sourceLine" id="cb20-5" title="5">p2=<span class="fl">0.75</span></a>
<a class="sourceLine" id="cb20-6" title="6">xx&lt;-<span class="kw">sample</span>(x,<span class="dt">size =</span> n<span class="op">*</span>p1)</a>
<a class="sourceLine" id="cb20-7" title="7">yy&lt;-<span class="kw">sample</span>(y,<span class="dt">size =</span> n<span class="op">*</span>p2)</a>
<a class="sourceLine" id="cb20-8" title="8">a&lt;-<span class="kw">c</span>(xx,yy)</a>
<a class="sourceLine" id="cb20-9" title="9"><span class="kw">hist</span>(a)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAq1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa225C229u22/+2/7a2///T09PbkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v///8gx7SAAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIjElEQVR4nO2da3vbJgBGlSxZvHSXuOlWp7tG2SXb1KaLEtv//5dNgLAVxfBKAgzG7/nQOpYAcx5uQggVa2KliP0DUoeCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCBBe0uinOH9X/F5s/Ood//8d3gnezovjWW3SRBT1fn/oWVBcNV96i26+gV5SFd0FVcXLrMbooJejjZVGcfHMv/DQIRQ/viuKL72XhWt0VxdmtNNfk9Zfr4vR+/XDdnPemyfdyXlw8XBYn79cfZ81Z22Q2EcgotaJNuOnEEFQVRStGC2q/ESc2p4gcXm6/Pn+s1eEm240gxaVWq9hG0BW0DTedfQjStIJEKXhcf5INhapiT7PW25XM1MXjqtTezu/X/zWhvnwUJ11JQVcibPG+PV/SjWBbxTrhphNBUPOLz/5qjypBbUtUqkIlPjcilKBFe+LnPy5FBM33jQn1byfn3QhetkFtuOlEEKS+US2OzJKuhSJr+vOLvK5+1BGI0rdu/90K6kbQFbQNN50YbdDztWoafms9qPzK2rXQn7uChNGznz/PjYK6EbysYjrcdOKMg55/utRN6oASpEwszYIMJagTbjrRBoqrD9sWx9wGybzKgrFppHcIMrRBnXDTiSCo+d3fyXomOx6RG3MvpkvQ+ePzjbkNMvRinXDTiVGC7rbDkxqMgzZtkLWR7o6Dem3QQTbS60+iBXpzv26HzfftQPgHFaD56uv7V73Y2a9V85VJUCeCXi+mwk3//alOd5T9y/5YJCeolHMVTelwqRceSU5Qe/3k95LcgeQErZ/fzdpr/SRIT1BiUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAiQgaCij9/YvcYWheLfl8QUpBfWen8KzoWEBFV63W3t8ZlHZ9IRtLrZLtxOZJGuIB1By/lCf6wTqmTpCGIJQlT6AUC2QQb0M7UJlZ+0BCUJBQHSEbSci5an5kDRhBQk+69Oh79/Xl17JSWoVROzm38lJClBT7OF+NgbKAa6kt5NJEEDnp4eUIIyFqQejLWO/9Qo6GKtm2t7dMGIWcWGODq5tQykcxekFDl04pkLEkOcRXNNOr2LylmQaGGUGfNcRlW0G9ZUhlMyFrSc4+eMK7kHlGilj1DQANR8kKyBRymobDJunejRFxjNiccoqJQNkKpBu9nMKJYXRyhIFw/bbLPWonb3sUYXkEiCdPEwlQ11sJ1zXd0cn6A2808zp9nmnAWJHVec9xTJWlCC0e1Og4JAGpEEeVmYkLOg0uUi/ihmFH3cLM1a0MJndAGJNlD0sataxoKa69SFz+jCEe+uBnuxXal5jY2C9hzd7jRiCZIboZdunX3OguqT20rsyM+r+Zep6Q9iPqiyzDaPjC4gEQeKQpDb+tWMBekSVDotbMlYUNsGVW7DxZwFqaEiZxT7qXmNjYL2HN3uNOII4rWYIbXe39N6+WOYUdSUTtNCRyCIA8Veav0veKnRS633t211x4ToQhC5F3NbQp+xoEHAm4tHLgg/9ZyxoM1A0VxABjyzmrGg9raP7Wp+wFPPGQta3Szk/5YHnWKVIPR82J6q2Nv27ba2NYrwqecwgoCQ/ZYg64wiHAtkLEjMKK7VYnov0XkkEUGqeDg+apm1oAHEGSgejqBIA8VUBMFbz9G6+TQE4VvP5oFi2BnFNAQNuPW8rxIEdg6Agno4/hj9Ycit5z0NFIEBKMhrgRp363k/A8U0BSV06zlRQfFuPYM2JxlBPpgmaGSO4wjqdFE+ohsV6CAEDVhpP2DSMWNBQ+4YGp/E3BHdmN9wEIIGLV6AzytkLGgY6HmFoxcUJLoDEORt07asBfno6CloUHRjA1EQCJS/ILfJlyMQ1ItubCAKAoEOQRC8yhoT3dhA6QvyBgWFiI6CXp01cj3L8QlyyzEFURAFgbMoCJxFQeCsvQpyu1d/BIL6h0PkyHN0+QrytAQvW0FTl+C5Lvg5FEGTF1AFznEyggYvwXtVYpIinKBE31AXlpFt0EJ9SOoNdWEZV+CSfENdWIKs282JMAubkyYFQW7H3Q67Bnc73U+kFOR2nIIoyO04BVGQ23EKoiC34/kLygkKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQECCXItgWIXERjujVbW3d/sAYdkLR4Veq43XwDCaotN19XN42ByvA7xVZztdGQNeiApOvm0Mj9jsMIkptZmQ4+zRZr077Van2EcVd0W9ABSavYx+2YHUZQdf4B3b7fXUwGGDAFHZD001fjt24JIqj5IfANOLvfWqqyADaBsL3w1Jp0ffr3HDZhPUIIEiUZCTIsoFGFw1pErGtv7ElXYnHlyLddhhA04B1KtaWNBoJMQQckrbYZHfdagwCCZDWxCzIWAlzFrGu3QNKqbVPt3FD8CqrEKKVql5ns+BmVGsVUxkzCRtocVMdvSFqgxI9rqmMMFC37pIFu3rofOE5arUKNXsUkFkFPM0shsA8UrUEHJC2aqJEPd0cQ1NYDg4XKdqlhD4qTFhcyCXTzWUFBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBEheUGleMLYXUhckFps5vuLdjcQFLd/ejl116ZnEBQnqqHUsdUFVUZz+yRJkRNYuVjEzcskuerFiUBIXJArPch5zY9TEBalVwWXEfj51QdGhIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIA/wPuWLewn/nJdgAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb21-2" title="2">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n) </a>
<a class="sourceLine" id="cb21-3" title="3">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dt">mean =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb21-4" title="4">p1=<span class="fl">0.5</span></a>
<a class="sourceLine" id="cb21-5" title="5">p2=<span class="fl">0.5</span></a>
<a class="sourceLine" id="cb21-6" title="6">xx&lt;-<span class="kw">sample</span>(x,<span class="dt">size =</span> n<span class="op">*</span>p1)</a>
<a class="sourceLine" id="cb21-7" title="7">yy&lt;-<span class="kw">sample</span>(y,<span class="dt">size =</span> n<span class="op">*</span>p2)</a>
<a class="sourceLine" id="cb21-8" title="8">a&lt;-<span class="kw">c</span>(xx,yy)</a>
<a class="sourceLine" id="cb21-9" title="9"><span class="kw">hist</span>(a)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-1" class="section level1">
<h1>Question</h1>
<p>A compound Poisson process is a stochastic process {X(t),t ≥ 0} that can be represented as the random sum <span class="math inline">\(X(t)=\sum_{i=1}^{N(t)}Y_i\)</span> t ≥ 0, where {N(t),t ≥ 0} is a Poisson process and Y 1 ,Y 2 ,… are iid and independent of {N(t),t ≥ 0}. Write a program to simulate a compound Poisson(λ)–Gamma process (Y has a Gamma distribution). Estimate the mean and the variance of X(10) for several choices of the parameters and compare with the theoretical values. Hint: Show that E[X(t)] = λtE[Y1] and Var(X(t)) = λtE[Y1^2].</p>
</div>
<div id="answer-3" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">a&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb22-2" title="2"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){</a>
<a class="sourceLine" id="cb22-3" title="3">N&lt;-<span class="kw">rpois</span>(<span class="dv">10</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb22-4" title="4">x0&lt;-<span class="kw">rgamma</span>(N,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb22-5" title="5">a[j]&lt;-(<span class="kw">sum</span>(x0[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]))</a>
<a class="sourceLine" id="cb22-6" title="6">}</a>
<a class="sourceLine" id="cb22-7" title="7">a</a></code></pre></div>
<pre><code>##   [1] 14.926006  7.804658  7.380346  7.534861  6.973468  7.786424 15.637569
##   [8] 10.491416  9.804268 10.698379 10.102836  8.801783  9.012466 11.101932
##  [15] 11.164242 10.481735 12.969082  5.276689  5.797265  7.458737  6.454625
##  [22]  9.856144 11.347099 13.017223 19.698614  4.912839  8.225615  5.363721
##  [29] 16.034423 17.375675  9.093045 15.651307 11.785803  9.213497 13.765869
##  [36] 14.549801 11.975741  5.493752 13.672605  9.607795  7.423570 12.952384
##  [43]  7.980252  9.736758  6.374467  7.575541  8.402018  7.786418  8.166720
##  [50] 12.517738  7.501773  6.813026  8.284195 13.480831 10.606301 10.820147
##  [57]  7.403874  6.601455 10.206855 16.660622 11.406879  7.838381 12.500054
##  [64] 12.124924 10.508716  7.557264 11.861710 11.877885  6.180084 12.716158
##  [71]  8.618805  9.103618  6.242398 11.908600  7.824446 10.363272 10.664508
##  [78]  9.600529 12.013424 10.239067  8.216564  6.483608  7.873052 10.231337
##  [85]  7.794364  9.239032 12.450166 11.418709  9.736158  8.787569  7.787830
##  [92]  6.334514  9.660684  5.535706 10.355571  9.225896  8.239707  7.725219
##  [99]  9.278437  7.573623</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">mean</span>(a)</a></code></pre></div>
<pre><code>## [1] 9.806928</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">var</span>(a)</a></code></pre></div>
<pre><code>## [1] 8.444654</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">a&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb28-2" title="2"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){</a>
<a class="sourceLine" id="cb28-3" title="3">N&lt;-<span class="kw">rpois</span>(<span class="dv">10</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb28-4" title="4">x0&lt;-<span class="kw">rgamma</span>(N,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb28-5" title="5">a[j]&lt;-(<span class="kw">sum</span>(x0[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]))</a>
<a class="sourceLine" id="cb28-6" title="6">}</a>
<a class="sourceLine" id="cb28-7" title="7"><span class="kw">mean</span>(a)</a></code></pre></div>
<pre><code>## [1] 31.31902</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">var</span>(a)</a></code></pre></div>
<pre><code>## [1] 20.62787</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">a&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb32-2" title="2"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){</a>
<a class="sourceLine" id="cb32-3" title="3">N&lt;-<span class="kw">rpois</span>(<span class="dv">10</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb32-4" title="4">x0&lt;-<span class="kw">rgamma</span>(N,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb32-5" title="5">a[j]&lt;-(<span class="kw">sum</span>(x0[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]))</a>
<a class="sourceLine" id="cb32-6" title="6">}</a>
<a class="sourceLine" id="cb32-7" title="7">a</a></code></pre></div>
<pre><code>##   [1] 26.94063 32.57090 28.93332 32.98333 27.96157 26.86326 29.25300 21.16355
##   [9] 35.90048 33.24189 28.98134 31.04070 24.80987 31.67904 32.45480 29.70806
##  [17] 22.69540 24.90718 33.09988 30.60877 33.33790 32.83736 32.09634 34.05758
##  [25] 25.63823 30.79486 29.81079 29.28071 40.06816 32.93553 32.94251 33.32087
##  [33] 30.04032 33.78370 38.29629 31.04201 29.18535 30.43497 35.14630 34.22215
##  [41] 15.90475 37.50992 27.14595 26.31286 24.23929 34.09780 41.33151 18.92791
##  [49] 32.86680 22.86664 32.80114 28.41100 24.75500 22.60021 32.25142 26.79107
##  [57] 41.30716 28.95007 36.31064 20.96250 33.30687 40.97742 29.90381 31.36809
##  [65] 25.82094 27.27536 22.82167 33.68269 24.22340 35.28334 32.21662 43.15731
##  [73] 32.68501 31.94763 29.08131 28.32689 22.69762 31.21028 42.13275 28.89946
##  [81] 31.44817 32.15920 39.18514 34.78387 29.37101 28.35966 34.86391 23.82850
##  [89] 29.36802 35.24437 22.19328 33.96189 33.50099 26.04600 22.44869 30.80937
##  [97] 23.26703 34.38872 28.43380 20.97719</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">mean</span>(a)</a></code></pre></div>
<pre><code>## [1] 30.3307</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw">var</span>(a)</a></code></pre></div>
<pre><code>## [1] 28.21057</code></pre>
</div>
<div id="section" class="section level1">
<h1>5.4</h1>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">pbetaa&lt;-<span class="cf">function</span>(xx){</a>
<a class="sourceLine" id="cb38-2" title="2">  m=<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb38-3" title="3">  x=<span class="kw">runif</span>(m,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>xx)</a>
<a class="sourceLine" id="cb38-4" title="4">  theta=<span class="kw">mean</span>(<span class="dv">30</span><span class="op">*</span>xx<span class="op">*</span>x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb38-5" title="5">  <span class="kw">return</span>(theta)</a>
<a class="sourceLine" id="cb38-6" title="6">}</a>
<a class="sourceLine" id="cb38-7" title="7"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">pbetaa</span>(<span class="fl">0.1</span>),<span class="kw">pbeta</span>(<span class="fl">0.1</span>,<span class="dv">3</span>,<span class="dv">3</span>)))</a></code></pre></div>
<pre><code>## [1] 0.008606236 0.008560000</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">pbetaa</span>(<span class="fl">0.2</span>),<span class="kw">pbeta</span>(<span class="fl">0.2</span>,<span class="dv">3</span>,<span class="dv">3</span>)))</a></code></pre></div>
<pre><code>## [1] 0.05805774 0.05792000</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">pbetaa</span>(<span class="fl">0.3</span>),<span class="kw">pbeta</span>(<span class="fl">0.3</span>,<span class="dv">3</span>,<span class="dv">3</span>)))</a></code></pre></div>
<pre><code>## [1] 0.163031 0.163080</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">pbetaa</span>(<span class="fl">0.4</span>),<span class="kw">pbeta</span>(<span class="fl">0.4</span>,<span class="dv">3</span>,<span class="dv">3</span>)))</a></code></pre></div>
<pre><code>## [1] 0.3155059 0.3174400</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">pbetaa</span>(<span class="fl">0.5</span>),<span class="kw">pbeta</span>(<span class="fl">0.5</span>,<span class="dv">3</span>,<span class="dv">3</span>)))</a></code></pre></div>
<pre><code>## [1] 0.5007651 0.5000000</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">pbetaa</span>(<span class="fl">0.6</span>),<span class="kw">pbeta</span>(<span class="fl">0.6</span>,<span class="dv">3</span>,<span class="dv">3</span>)))</a></code></pre></div>
<pre><code>## [1] 0.6821784 0.6825600</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">pbetaa</span>(<span class="fl">0.7</span>),<span class="kw">pbeta</span>(<span class="fl">0.7</span>,<span class="dv">3</span>,<span class="dv">3</span>)))</a></code></pre></div>
<pre><code>## [1] 0.8409837 0.8369200</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">pbetaa</span>(<span class="fl">0.8</span>),<span class="kw">pbeta</span>(<span class="fl">0.8</span>,<span class="dv">3</span>,<span class="dv">3</span>)))</a></code></pre></div>
<pre><code>## [1] 0.9505345 0.9420800</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">pbetaa</span>(<span class="fl">0.9</span>),<span class="kw">pbeta</span>(<span class="fl">0.9</span>,<span class="dv">3</span>,<span class="dv">3</span>)))</a></code></pre></div>
<pre><code>## [1] 0.9994968 0.9914400</code></pre>
</div>
<div id="section-1" class="section level1">
<h1>5.9</h1>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">Ra&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb56-2" title="2">x&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb56-3" title="3">u &lt;-<span class="st"> </span><span class="kw">runif</span>(Ra<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb56-4" title="4">v &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u</a>
<a class="sourceLine" id="cb56-5" title="5">g&lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dt">length=</span>(Ra<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb56-6" title="6">sigma=<span class="fl">0.1</span></a>
<a class="sourceLine" id="cb56-7" title="7"></a>
<a class="sourceLine" id="cb56-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(Ra<span class="op">/</span><span class="dv">2</span>)) {</a>
<a class="sourceLine" id="cb56-9" title="9">g[i] &lt;-<span class="st"> </span>x<span class="op">*</span>u[i] <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>u[i]<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb56-10" title="10">g[i] &lt;-<span class="st"> </span>g[i]<span class="op">+</span>x<span class="op">*</span>v[i] <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>v[i]<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb56-11" title="11">g[i] &lt;-<span class="st"> </span>g[i]<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb56-12" title="12">}</a>
<a class="sourceLine" id="cb56-13" title="13"><span class="kw">var</span>(g)</a></code></pre></div>
<pre><code>## [1] 1.215549</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">g1&lt;-<span class="kw">var</span>(g)</a>
<a class="sourceLine" id="cb58-2" title="2"></a>
<a class="sourceLine" id="cb58-3" title="3">u &lt;-<span class="st"> </span><span class="kw">runif</span>(Ra<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb58-4" title="4">v &lt;-<span class="st"> </span><span class="kw">runif</span>(Ra<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb58-5" title="5">g&lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dt">length=</span>(Ra<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb58-6" title="6"></a>
<a class="sourceLine" id="cb58-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(Ra<span class="op">/</span><span class="dv">2</span>)) {</a>
<a class="sourceLine" id="cb58-8" title="8">g[i] &lt;-<span class="st"> </span>x<span class="op">*</span>u[i] <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>u[i]<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb58-9" title="9">g[i] &lt;-<span class="st"> </span>g[i]<span class="op">+</span>x<span class="op">*</span>v[i] <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>v[i]<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb58-10" title="10">g[i] &lt;-<span class="st"> </span>g[i]<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb58-11" title="11">}</a>
<a class="sourceLine" id="cb58-12" title="12"><span class="kw">var</span>(g)</a></code></pre></div>
<pre><code>## [1] 1.597907</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">g2&lt;-<span class="kw">var</span>(g)</a>
<a class="sourceLine" id="cb60-2" title="2">(g2<span class="op">-</span>g1)<span class="op">/</span>g2<span class="op">*</span><span class="dv">100</span></a></code></pre></div>
<pre><code>## [1] 23.92866</code></pre>
</div>
<div id="section-2" class="section level1">
<h1>5.13</h1>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb62-2" title="2">theta.hat &lt;-<span class="st"> </span>se &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb62-3" title="3">g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb62-4" title="4"><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span> <span class="op">+</span><span class="kw">log</span>(x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)))<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb62-5" title="5">}</a>
<a class="sourceLine" id="cb62-6" title="6"></a>
<a class="sourceLine" id="cb62-7" title="7">g0 &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb62-8" title="8"><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span> <span class="op">+</span><span class="kw">log</span>(x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)))<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb62-9" title="9">}</a>
<a class="sourceLine" id="cb62-10" title="10"></a>
<a class="sourceLine" id="cb62-11" title="11">x &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#f0=1</span></a>
<a class="sourceLine" id="cb62-12" title="12">fg &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">-</span><span class="kw">g0</span>(x)</a>
<a class="sourceLine" id="cb62-13" title="13">theta.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb62-14" title="14">se[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb62-15" title="15"></a>
<a class="sourceLine" id="cb62-16" title="16">u&lt;-<span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb62-17" title="17">x &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u) <span class="co">#f1=e^-x</span></a>
<a class="sourceLine" id="cb62-18" title="18">fg &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">-</span><span class="kw">g0</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x)</a>
<a class="sourceLine" id="cb62-19" title="19">theta.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb62-20" title="20">se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb62-21" title="21"></a>
<a class="sourceLine" id="cb62-22" title="22">u &lt;-<span class="st"> </span><span class="kw">runif</span>(m,<span class="dv">0</span>,<span class="dv">1</span>) <span class="co">#f2=xe^{-x^2/2}, x&gt;0,inverse transform method</span></a>
<a class="sourceLine" id="cb62-23" title="23">x &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))</a>
<a class="sourceLine" id="cb62-24" title="24">fg &lt;-<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">-</span><span class="st"> </span><span class="kw">g0</span>(x) <span class="op">/</span><span class="st"> </span>x<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>) )</a>
<a class="sourceLine" id="cb62-25" title="25">theta.hat[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb62-26" title="26">se[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb62-27" title="27"></a>
<a class="sourceLine" id="cb62-28" title="28">u &lt;-<span class="st"> </span><span class="kw">runif</span>(m,<span class="dv">0</span>,<span class="dv">1</span>) <span class="co">#f3=2xe^{-x^2/2}, x&gt;0,inverse transform method</span></a>
<a class="sourceLine" id="cb62-29" title="29">x &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb62-30" title="30">fg &lt;-<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">-</span><span class="kw">g0</span>(x) <span class="op">/</span><span class="st"> </span>x<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>) )<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb62-31" title="31">theta.hat[<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb62-32" title="32">se[<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb62-33" title="33"></a>
<a class="sourceLine" id="cb62-34" title="34">u &lt;-<span class="st"> </span><span class="kw">runif</span>(m,<span class="dv">0</span>,<span class="dv">1</span>) <span class="co">#f4=3xe^{-x^2/2}, x&gt;0,inverse transform method</span></a>
<a class="sourceLine" id="cb62-35" title="35">x &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u<span class="op">/</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb62-36" title="36">fg &lt;-<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">-</span><span class="kw">g0</span>(x) <span class="op">/</span><span class="st"> </span>x<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>) )<span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb62-37" title="37">theta.hat[<span class="dv">5</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb62-38" title="38">se[<span class="dv">5</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb62-39" title="39"></a>
<a class="sourceLine" id="cb62-40" title="40">theta.hat</a></code></pre></div>
<pre><code>## [1] 0.4012724 0.4046863 0.4008748 0.3991917 0.4230492</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">se</a></code></pre></div>
<pre><code>## [1] 0.07705369 0.15614385 0.13630841 0.06644579 0.02873197</code></pre>
</div>
<div id="section-3" class="section level1">
<h1>5.14</h1>
<p>0.401~0.402</p>
<div id="section-4" class="section level2">
<h2>6.5</h2>
</div>
</div>
<div id="question-2" class="section level1">
<h1>question</h1>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of χ2(2) data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-4" class="section level1">
<h1>answer</h1>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb66-2" title="2">alpha=<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb66-3" title="3">t&lt;-<span class="kw">qt</span>(<span class="fl">0.975</span>,(n<span class="dv">-2</span>))</a>
<a class="sourceLine" id="cb66-4" title="4">re&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb66-5" title="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){</a>
<a class="sourceLine" id="cb66-6" title="6">  x&lt;-<span class="kw">rchisq</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb66-7" title="7">  <span class="cf">if</span>(((<span class="kw">mean</span>(x)<span class="op">-</span>t<span class="op">*</span><span class="kw">sd</span>(x))<span class="op">&lt;</span><span class="dv">2</span>)<span class="op">&amp;</span>(<span class="dv">2</span><span class="op">&lt;</span>(<span class="kw">mean</span>(x)<span class="op">+</span>t<span class="op">*</span><span class="kw">sd</span>(x)))) re&lt;-re<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb66-8" title="8">  <span class="cf">else</span> re&lt;-re</a>
<a class="sourceLine" id="cb66-9" title="9">}</a>
<a class="sourceLine" id="cb66-10" title="10">re<span class="op">/</span><span class="dv">1000</span></a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div id="a" class="section level2">
<h2>6.A</h2>
</div>
</div>
<div id="question-3" class="section level1">
<h1>question</h1>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level α, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) χ2(1), (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test H0 : µ = µ0 vs H0 : µ = µ0, where µ0 is the mean of χ2(1), Uniform(0,2), and Exponential(1), respectively.</p>
</div>
<div id="answer-5" class="section level1">
<h1>answer</h1>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">alpha &lt;-<span class="st"> </span><span class="dv">1</span>; beta &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># null hypothesis!</span></a>
<a class="sourceLine" id="cb68-2" title="2">m &lt;-<span class="st"> </span><span class="fl">1e3</span>; n &lt;-<span class="st"> </span><span class="dv">10</span>; <span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb68-3" title="3">beta.hat &lt;-<span class="st"> </span>beta.se &lt;-<span class="st"> </span>p.val1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb68-4" title="4">x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb68-5" title="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb68-6" title="6">y &lt;-<span class="st"> </span>alpha <span class="op">+</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rt</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb68-7" title="7">coe &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">lm</span>(y<span class="op">~</span>x))<span class="op">$</span>coef</a>
<a class="sourceLine" id="cb68-8" title="8">beta.hat[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">1</span>];beta.se[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb68-9" title="9">p.val1[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">4</span>] <span class="co"># t-test p-value</span></a>
<a class="sourceLine" id="cb68-10" title="10">}</a>
<a class="sourceLine" id="cb68-11" title="11">p.val2 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(beta.hat<span class="op">/</span>beta.se),n<span class="dv">-2</span>))</a>
<a class="sourceLine" id="cb68-12" title="12"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p.val1<span class="op">&lt;=</span><span class="fl">0.05</span>),<span class="kw">mean</span>(p.val2<span class="op">&lt;=</span><span class="fl">0.05</span>)))</a></code></pre></div>
<pre><code>## [1] 0.051 0.051</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1">alpha &lt;-<span class="st"> </span><span class="dv">1</span>; beta &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># null hypothesis!</span></a>
<a class="sourceLine" id="cb70-2" title="2">m &lt;-<span class="st"> </span><span class="fl">1e3</span>; n &lt;-<span class="st"> </span><span class="dv">10</span>; <span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb70-3" title="3">beta.hat &lt;-<span class="st"> </span>beta.se &lt;-<span class="st"> </span>p.val1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb70-4" title="4">x &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb70-5" title="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb70-6" title="6">y &lt;-<span class="st"> </span>alpha <span class="op">+</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rt</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb70-7" title="7">coe &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">lm</span>(y<span class="op">~</span>x))<span class="op">$</span>coef</a>
<a class="sourceLine" id="cb70-8" title="8">beta.hat[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">1</span>];beta.se[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb70-9" title="9">p.val1[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">4</span>] <span class="co"># t-test p-value</span></a>
<a class="sourceLine" id="cb70-10" title="10">}</a>
<a class="sourceLine" id="cb70-11" title="11">p.val2 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(beta.hat<span class="op">/</span>beta.se),n<span class="dv">-2</span>))</a>
<a class="sourceLine" id="cb70-12" title="12"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p.val1<span class="op">&lt;=</span><span class="fl">0.05</span>),<span class="kw">mean</span>(p.val2<span class="op">&lt;=</span><span class="fl">0.05</span>)))</a></code></pre></div>
<pre><code>## [1] 0.059 0.059</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">alpha &lt;-<span class="st"> </span><span class="dv">1</span>; beta &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># null hypothesis!</span></a>
<a class="sourceLine" id="cb72-2" title="2">m &lt;-<span class="st"> </span><span class="fl">1e3</span>; n &lt;-<span class="st"> </span><span class="dv">10</span>; <span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb72-3" title="3">beta.hat &lt;-<span class="st"> </span>beta.se &lt;-<span class="st"> </span>p.val1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb72-4" title="4">x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n)</a>
<a class="sourceLine" id="cb72-5" title="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb72-6" title="6">y &lt;-<span class="st"> </span>alpha <span class="op">+</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rt</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb72-7" title="7">coe &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">lm</span>(y<span class="op">~</span>x))<span class="op">$</span>coef</a>
<a class="sourceLine" id="cb72-8" title="8">beta.hat[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">1</span>];beta.se[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb72-9" title="9">p.val1[i] &lt;-<span class="st"> </span>coe[<span class="dv">2</span>,<span class="dv">4</span>] <span class="co"># t-test p-value</span></a>
<a class="sourceLine" id="cb72-10" title="10">}</a>
<a class="sourceLine" id="cb72-11" title="11">p.val2 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(beta.hat<span class="op">/</span>beta.se),n<span class="dv">-2</span>))</a>
<a class="sourceLine" id="cb72-12" title="12"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p.val1<span class="op">&lt;=</span><span class="fl">0.05</span>),<span class="kw">mean</span>(p.val2<span class="op">&lt;=</span><span class="fl">0.05</span>)))</a></code></pre></div>
<pre><code>## [1] 0.071 0.071</code></pre>
<div id="homework" class="section level2">
<h2>homework</h2>
</div>
</div>
<div id="question-4" class="section level1">
<h1>question</h1>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.</p>
</div>
<div id="answer-6" class="section level1">
<h1>answer</h1>
<p>H0:p1=p2 H1:p1≠p2 McNemar test</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">a&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">6510</span>,<span class="dv">3490</span>,<span class="dv">6760</span>,<span class="dv">3240</span>),<span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb74-2" title="2">xq&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb74-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){</a>
<a class="sourceLine" id="cb74-4" title="4">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){</a>
<a class="sourceLine" id="cb74-5" title="5">   xq&lt;-xq<span class="op">+</span>a[i,j]<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sum</span>(a[i,])<span class="op">/</span><span class="kw">sum</span>(a[,j])</a>
<a class="sourceLine" id="cb74-6" title="6">  }</a>
<a class="sourceLine" id="cb74-7" title="7">}</a>
<a class="sourceLine" id="cb74-8" title="8"><span class="dv">20000</span><span class="op">*</span>(xq<span class="dv">-1</span>)</a></code></pre></div>
<pre><code>## [1] 13.99665</code></pre>
</div>
<div id="example-6.8" class="section level1">
<h1>Example 6.8:</h1>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="kw">library</span>(mvtnorm)</a>
<a class="sourceLine" id="cb76-2" title="2">n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>) <span class="co">#sample sizes</span></a>
<a class="sourceLine" id="cb76-3" title="3">d&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb76-4" title="4">cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="fl">0.95</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>) <span class="co">#crit. values for each n</span></a>
<a class="sourceLine" id="cb76-5" title="5">p.reject &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n)) <span class="co">#to store sim. results</span></a>
<a class="sourceLine" id="cb76-6" title="6">m &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#num. repl. each sim.</span></a>
<a class="sourceLine" id="cb76-7" title="7"></a>
<a class="sourceLine" id="cb76-8" title="8">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x,n) {<span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb76-9" title="9">xbar &lt;-<span class="st"> </span><span class="kw">colMeans</span>(x)</a>
<a class="sourceLine" id="cb76-10" title="10">sig&lt;-<span class="kw">solve</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">cov</span>(x)<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb76-11" title="11">bb&lt;-<span class="cf">function</span>(x) x<span class="op">-</span>xbar</a>
<a class="sourceLine" id="cb76-12" title="12">y&lt;-<span class="kw">apply</span>(x,<span class="dv">1</span>,bb)</a>
<a class="sourceLine" id="cb76-13" title="13">y&lt;-<span class="kw">t</span>(y)</a>
<a class="sourceLine" id="cb76-14" title="14">z&lt;-(y<span class="op">%*%</span>sig<span class="op">%*%</span><span class="kw">t</span>(y))<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb76-15" title="15"><span class="kw">return</span>(<span class="kw">mean</span>(z)<span class="op">/</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb76-16" title="16">}</a>
<a class="sourceLine" id="cb76-17" title="17"></a>
<a class="sourceLine" id="cb76-18" title="18"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</a>
<a class="sourceLine" id="cb76-19" title="19">sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#test decisions</span></a>
<a class="sourceLine" id="cb76-20" title="20"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb76-21" title="21">x &lt;-<span class="st"> </span><span class="kw">rmvnorm</span>(n[i],<span class="kw">rep</span>(<span class="dv">0</span>,d),<span class="kw">diag</span>(d))</a>
<a class="sourceLine" id="cb76-22" title="22"><span class="co">#test decision is 1 (reject) or 0</span></a>
<a class="sourceLine" id="cb76-23" title="23">sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(n[i]<span class="op">*</span><span class="kw">abs</span>(<span class="kw">sk</span>(x,n[i])) <span class="op">&gt;=</span><span class="st"> </span>cv )</a>
<a class="sourceLine" id="cb76-24" title="24">}</a>
<a class="sourceLine" id="cb76-25" title="25">p.reject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co">#proportion rejected</span></a>
<a class="sourceLine" id="cb76-26" title="26">}</a>
<a class="sourceLine" id="cb76-27" title="27">p.reject</a></code></pre></div>
<pre><code>## [1] 0.006 0.025 0.025 0.033 0.059 0.051</code></pre>
</div>
<div id="example-6.10" class="section level1">
<h1>Example 6.10:</h1>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1">alpha &lt;-<span class="st"> </span><span class="fl">.1</span></a>
<a class="sourceLine" id="cb78-2" title="2">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb78-3" title="3">m &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb78-4" title="4">epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</a>
<a class="sourceLine" id="cb78-5" title="5">N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</a>
<a class="sourceLine" id="cb78-6" title="6">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb78-7" title="7">x&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>n,<span class="dt">ncol=</span>d)</a>
<a class="sourceLine" id="cb78-8" title="8"><span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb78-9" title="9">cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha, d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb78-10" title="10"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></a>
<a class="sourceLine" id="cb78-11" title="11">  e &lt;-<span class="st"> </span>epsilon[j]</a>
<a class="sourceLine" id="cb78-12" title="12">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb78-13" title="13">  </a>
<a class="sourceLine" id="cb78-14" title="14">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb78-15" title="15">    sigma &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,<span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</a>
<a class="sourceLine" id="cb78-16" title="16">    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb78-17" title="17">      t&lt;-<span class="kw">rmvnorm</span>(<span class="dv">1</span>, <span class="kw">rep</span>(<span class="dv">0</span>,d),<span class="kw">diag</span>(<span class="kw">rep</span>(sigma[k],d)))</a>
<a class="sourceLine" id="cb78-18" title="18">      x[k,] &lt;-<span class="kw">t</span>(<span class="kw">as.matrix</span>(t[<span class="dv">1</span>,]))</a>
<a class="sourceLine" id="cb78-19" title="19">      }</a>
<a class="sourceLine" id="cb78-20" title="20">    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(n<span class="op">*</span><span class="kw">abs</span>(<span class="kw">sk</span>(x,n)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb78-21" title="21">}</a>
<a class="sourceLine" id="cb78-22" title="22">pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb78-23" title="23">}</a>
<a class="sourceLine" id="cb78-24" title="24"><span class="co">#plot power vs epsilon</span></a>
<a class="sourceLine" id="cb78-25" title="25"><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb78-26" title="26"><span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb78-27" title="27"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb78-28" title="28">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></a>
<a class="sourceLine" id="cb78-29" title="29"><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb78-30" title="30"><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-5" class="section level1">
<h1>7.7</h1>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="kw">data</span>(patch, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</a>
<a class="sourceLine" id="cb79-2" title="2">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(patch)</a>
<a class="sourceLine" id="cb79-3" title="3">B&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb79-4" title="4">fpc&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb79-5" title="5"><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</a>
<a class="sourceLine" id="cb79-6" title="6">xstar &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>n),<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb79-7" title="7">patchstar&lt;-patch[xstar,<span class="dv">2</span><span class="op">:</span><span class="dv">6</span>]</a>
<a class="sourceLine" id="cb79-8" title="8">r&lt;-<span class="kw">eigen</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">cov</span>(patchstar)<span class="op">/</span>n)<span class="op">$</span>values</a>
<a class="sourceLine" id="cb79-9" title="9">fpc[b]&lt;-r[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(r)</a>
<a class="sourceLine" id="cb79-10" title="10">}</a>
<a class="sourceLine" id="cb79-11" title="11">r0&lt;-<span class="kw">eigen</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">cov</span>(patch[,<span class="dv">2</span><span class="op">:</span><span class="dv">6</span>])<span class="op">/</span>n)<span class="op">$</span>values</a>
<a class="sourceLine" id="cb79-12" title="12">fpc0&lt;-r0[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(r0)</a>
<a class="sourceLine" id="cb79-13" title="13">fpcstar&lt;-<span class="kw">mean</span>(fpc)</a>
<a class="sourceLine" id="cb79-14" title="14">sefpc&lt;-<span class="kw">sd</span>(fpc)</a>
<a class="sourceLine" id="cb79-15" title="15"><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>fpc0,<span class="dt">bias=</span>fpcstar<span class="op">-</span>fpc0,<span class="dt">se=</span>sefpc),<span class="dv">3</span>)</a></code></pre></div>
<pre><code>## original     bias       se 
##    0.911   -0.011    0.059</code></pre>
</div>
<div id="section-6" class="section level1">
<h1>7.8</h1>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">fpcj&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb81-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb81-3" title="3">patchi&lt;-patch[<span class="op">-</span>i,<span class="dv">2</span><span class="op">:</span><span class="dv">6</span>]</a>
<a class="sourceLine" id="cb81-4" title="4">r&lt;-<span class="kw">eigen</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">cov</span>(patchi)<span class="op">/</span>n)<span class="op">$</span>values</a>
<a class="sourceLine" id="cb81-5" title="5">fpcj[i]&lt;-r[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(r)</a>
<a class="sourceLine" id="cb81-6" title="6">}</a>
<a class="sourceLine" id="cb81-7" title="7">bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(fpcj) <span class="op">-</span><span class="st"> </span>fpc0)</a>
<a class="sourceLine" id="cb81-8" title="8">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((fpcj <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(fpcj))<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb81-9" title="9"><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>fpc0,<span class="dt">bias=</span>bias,<span class="dt">se=</span>se),<span class="dv">3</span>)</a></code></pre></div>
<pre><code>## original     bias       se 
##    0.911   -0.023    0.082</code></pre>
</div>
<div id="section-7" class="section level1">
<h1>7.9</h1>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb83-2" title="2">boot.fpc&lt;-<span class="cf">function</span>(x,i){</a>
<a class="sourceLine" id="cb83-3" title="3">  n&lt;-<span class="kw">nrow</span>(x)</a>
<a class="sourceLine" id="cb83-4" title="4">  r&lt;-<span class="kw">eigen</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">cov</span>(x[i,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])<span class="op">/</span>n)<span class="op">$</span>values</a>
<a class="sourceLine" id="cb83-5" title="5">  fpc&lt;-r[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(r)</a>
<a class="sourceLine" id="cb83-6" title="6">  fpc</a>
<a class="sourceLine" id="cb83-7" title="7">}</a>
<a class="sourceLine" id="cb83-8" title="8">de&lt;-<span class="kw">boot</span>(<span class="dt">data =</span> patch[,<span class="dv">2</span><span class="op">:</span><span class="dv">6</span>],<span class="dt">statistic =</span> boot.fpc,<span class="dt">R =</span> <span class="dv">999</span>)</a>
<a class="sourceLine" id="cb83-9" title="9">ci&lt;-<span class="kw">boot.ci</span>(de,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</a>
<a class="sourceLine" id="cb83-10" title="10">ci.perc&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb83-11" title="11">ci.bca&lt;-ci<span class="op">$</span>bca[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb83-12" title="12">ci.perc</a></code></pre></div>
<pre><code>## [1] 0.7628046 0.9848845</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1">ci.bca</a></code></pre></div>
<pre><code>## [1] 0.7633512 0.9852339</code></pre>
</div>
<div id="b" class="section level1">
<h1>7.B</h1>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1">boot.ske&lt;-<span class="cf">function</span>(x,i) <span class="kw">mean</span>(((x[i]<span class="op">-</span><span class="kw">mean</span>(x[i]))<span class="op">/</span><span class="kw">sd</span>(x[i]))<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb87-2" title="2">ci.norm&lt;-ci.basic&lt;-ci.perc&lt;-ci.bca&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dv">1000</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb87-3" title="3"></a>
<a class="sourceLine" id="cb87-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){</a>
<a class="sourceLine" id="cb87-5" title="5">  x&lt;-<span class="kw">rnorm</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb87-6" title="6">  de&lt;-<span class="kw">boot</span>(<span class="dt">data =</span> x,<span class="dt">statistic =</span> boot.ske,<span class="dt">R=</span><span class="dv">99</span>)</a>
<a class="sourceLine" id="cb87-7" title="7">  ci&lt;-<span class="kw">boot.ci</span>(de,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb87-8" title="8">  ci.norm[i,]&lt;-ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb87-9" title="9">  ci.basic[i,]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb87-10" title="10">  ci.perc[i,]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb87-11" title="11">}</a>
<a class="sourceLine" id="cb87-12" title="12"><span class="kw">c</span>(<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]),<span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]))</a></code></pre></div>
<pre><code>## [1] NA NA</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="kw">c</span>(<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]),<span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]))</a></code></pre></div>
<pre><code>## [1] NA NA</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="kw">c</span>(<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]),<span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]))</a></code></pre></div>
<pre><code>## [1] NA NA</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">-</span><span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">-</span><span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">-</span><span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1">a&lt;-<span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb111-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){</a>
<a class="sourceLine" id="cb111-3" title="3">  x&lt;-<span class="kw">rchisq</span>(<span class="dv">100</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb111-4" title="4">  de&lt;-<span class="kw">boot</span>(<span class="dt">data =</span> x,<span class="dt">statistic =</span> boot.ske,<span class="dt">R=</span><span class="dv">99</span>)</a>
<a class="sourceLine" id="cb111-5" title="5">  ci&lt;-<span class="kw">boot.ci</span>(de,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb111-6" title="6">  ci.norm[i,]&lt;-ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb111-7" title="7">  ci.basic[i,]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb111-8" title="8">  ci.perc[i,]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb111-9" title="9">}</a>
<a class="sourceLine" id="cb111-10" title="10"><span class="kw">c</span>(<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]),<span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]))</a></code></pre></div>
<pre><code>## [1] NA NA</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="kw">c</span>(<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]),<span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]))</a></code></pre></div>
<pre><code>## [1] NA NA</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="kw">c</span>(<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]),<span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]))</a></code></pre></div>
<pre><code>## [1] NA NA</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;</span>a)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1"><span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;</span>a)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1"><span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;</span>a)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1"><span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;</span>a)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1"><span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;</span>a)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;</span>a)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;</span>a)<span class="op">-</span><span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;</span>a)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;</span>a)<span class="op">-</span><span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;</span>a)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1"><span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;</span>a)<span class="op">-</span><span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;</span>a)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
</div>
<div id="section-8" class="section level1">
<h1>8.2</h1>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb135-2" title="2">x&lt;-<span class="kw">rchisq</span>(<span class="dv">30</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb135-3" title="3">y&lt;-<span class="kw">rchisq</span>(<span class="dv">30</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb135-4" title="4">R &lt;-<span class="st"> </span><span class="dv">99</span>;z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y);K &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">60</span>;n&lt;-<span class="kw">length</span>(x);</a>
<a class="sourceLine" id="cb135-5" title="5">reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R);t0 &lt;-<span class="st"> </span><span class="kw">cor</span>(x, y,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</a>
<a class="sourceLine" id="cb135-6" title="6"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</a>
<a class="sourceLine" id="cb135-7" title="7">k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb135-8" title="8">x1 &lt;-<span class="st"> </span>z[k];y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] <span class="co">#complement of x1</span></a>
<a class="sourceLine" id="cb135-9" title="9">reps[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(x1, y1,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</a>
<a class="sourceLine" id="cb135-10" title="10">}</a>
<a class="sourceLine" id="cb135-11" title="11">p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(t0, reps)) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(t0))</a>
<a class="sourceLine" id="cb135-12" title="12">p0&lt;-<span class="kw">cor.test</span>(x,y,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb135-13" title="13"><span class="kw">print</span>(<span class="kw">c</span>(t0,p,p0))</a>
<a class="sourceLine" id="cb135-14" title="14">}</a></code></pre></div>
<pre><code>## [1] -0.1688543  0.3200000  0.3708270
## [1] 0.02825362 0.92000000 0.88234537
## [1] -0.06028921  0.75000000  0.75101566
## [1] -0.1087875  0.6000000  0.5657249
## [1] 0.09098999 0.62000000 0.63130833
## [1] 0.05183537 0.78000000 0.78516383
## [1] 0.1710790 0.3100000 0.3644803
## [1] 0.006896552 0.980000000 0.971894335
## [1] 0.1995551 0.3000000 0.2890875
## [1] -0.2164627  0.1900000  0.2494867</code></pre>
</div>
<div id="more" class="section level1">
<h1>more</h1>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1"><span class="kw">library</span>(RANN)</a>
<a class="sourceLine" id="cb137-2" title="2"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb137-3" title="3"><span class="kw">library</span>(energy)</a>
<a class="sourceLine" id="cb137-4" title="4"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb137-5" title="5">Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</a>
<a class="sourceLine" id="cb137-6" title="6">n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</a>
<a class="sourceLine" id="cb137-7" title="7"><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z);</a>
<a class="sourceLine" id="cb137-8" title="8">z &lt;-<span class="st"> </span>z[ix, ];</a>
<a class="sourceLine" id="cb137-9" title="9">NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># What is the first column?</span></a>
<a class="sourceLine" id="cb137-10" title="10">block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb137-11" title="11">block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb137-12" title="12">i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;=</span><span class="st"> </span>n1); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1)</a>
<a class="sourceLine" id="cb137-13" title="13">(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</a>
<a class="sourceLine" id="cb137-14" title="14">}</a>
<a class="sourceLine" id="cb137-15" title="15">m &lt;-<span class="st"> </span><span class="dv">100</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; <span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb137-16" title="16">n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">10</span>; R&lt;-<span class="dv">99</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</a>
<a class="sourceLine" id="cb137-17" title="17">eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</a>
<a class="sourceLine" id="cb137-18" title="18">boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</a>
<a class="sourceLine" id="cb137-19" title="19"><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</a>
<a class="sourceLine" id="cb137-20" title="20">ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb137-21" title="21">p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb137-22" title="22"><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)}</a>
<a class="sourceLine" id="cb137-23" title="23">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb137-24" title="24"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb137-25" title="25">x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ncol=</span>p)</a>
<a class="sourceLine" id="cb137-26" title="26">y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">3</span>),<span class="dt">ncol=</span>p)</a>
<a class="sourceLine" id="cb137-27" title="27">z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</a>
<a class="sourceLine" id="cb137-28" title="28">p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb137-29" title="29">p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb137-30" title="30">p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span>R,</a>
<a class="sourceLine" id="cb137-31" title="31"><span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb137-32" title="32">}</a>
<a class="sourceLine" id="cb137-33" title="33">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</a>
<a class="sourceLine" id="cb137-34" title="34">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb137-35" title="35">pow</a></code></pre></div>
<pre><code>## [1] 0.58 0.72 0.95</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1">m &lt;-<span class="st"> </span><span class="dv">100</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; <span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb139-2" title="2">n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">10</span>; R&lt;-<span class="dv">99</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</a>
<a class="sourceLine" id="cb139-3" title="3">eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</a>
<a class="sourceLine" id="cb139-4" title="4">boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</a>
<a class="sourceLine" id="cb139-5" title="5"><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</a>
<a class="sourceLine" id="cb139-6" title="6">ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb139-7" title="7">p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb139-8" title="8"><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)}</a>
<a class="sourceLine" id="cb139-9" title="9">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb139-10" title="10"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb139-11" title="11">x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ncol=</span>p)</a>
<a class="sourceLine" id="cb139-12" title="12">y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">ncol=</span>p)</a>
<a class="sourceLine" id="cb139-13" title="13">z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</a>
<a class="sourceLine" id="cb139-14" title="14">p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb139-15" title="15">p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb139-16" title="16">p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span>R,</a>
<a class="sourceLine" id="cb139-17" title="17"><span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb139-18" title="18">}</a>
<a class="sourceLine" id="cb139-19" title="19">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</a>
<a class="sourceLine" id="cb139-20" title="20">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb139-21" title="21">pow</a></code></pre></div>
<pre><code>## [1] 0.83 0.85 0.98</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1">m &lt;-<span class="st"> </span><span class="dv">100</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>;<span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb141-2" title="2">n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">10</span>; R&lt;-<span class="dv">99</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</a>
<a class="sourceLine" id="cb141-3" title="3">eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</a>
<a class="sourceLine" id="cb141-4" title="4">boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</a>
<a class="sourceLine" id="cb141-5" title="5"><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</a>
<a class="sourceLine" id="cb141-6" title="6">ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb141-7" title="7">p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb141-8" title="8"><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)}</a>
<a class="sourceLine" id="cb141-9" title="9">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb141-10" title="10"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb141-11" title="11">x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dv">1</span>),<span class="dt">ncol=</span>p)</a>
<a class="sourceLine" id="cb141-12" title="12">y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb141-13" title="13">z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</a>
<a class="sourceLine" id="cb141-14" title="14">p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb141-15" title="15">p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb141-16" title="16">p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span>R,</a>
<a class="sourceLine" id="cb141-17" title="17"><span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb141-18" title="18">}</a>
<a class="sourceLine" id="cb141-19" title="19">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</a>
<a class="sourceLine" id="cb141-20" title="20">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb141-21" title="21">pow</a></code></pre></div>
<pre><code>## [1] 0.43 0.65 0.71</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1">m &lt;-<span class="st"> </span><span class="dv">100</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>;<span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb143-2" title="2">n1 &lt;-<span class="dv">1</span>; n2 &lt;-<span class="st"> </span><span class="dv">10</span>; R&lt;-<span class="dv">99</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</a>
<a class="sourceLine" id="cb143-3" title="3">eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</a>
<a class="sourceLine" id="cb143-4" title="4">boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</a>
<a class="sourceLine" id="cb143-5" title="5"><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</a>
<a class="sourceLine" id="cb143-6" title="6">ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb143-7" title="7">p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb143-8" title="8"><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)}</a>
<a class="sourceLine" id="cb143-9" title="9">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb143-10" title="10"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb143-11" title="11">x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ncol=</span>p)</a>
<a class="sourceLine" id="cb143-12" title="12">y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ncol=</span>p)</a>
<a class="sourceLine" id="cb143-13" title="13">z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</a>
<a class="sourceLine" id="cb143-14" title="14">p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb143-15" title="15">p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb143-16" title="16">p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span>R,</a>
<a class="sourceLine" id="cb143-17" title="17"><span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb143-18" title="18">}</a>
<a class="sourceLine" id="cb143-19" title="19">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</a>
<a class="sourceLine" id="cb143-20" title="20">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb143-21" title="21">pow</a></code></pre></div>
<pre><code>## [1] 0.00 0.04 0.00</code></pre>
</div>
<div id="section-9" class="section level1">
<h1>9.3</h1>
<p><span class="math display">\[f(x)=\frac{1}{\pi(1+x^2)}\]</span></p>
<p><span class="math display">\[N(X_t,1)\]</span></p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1">f&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb145-2" title="2">  <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span>pi<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb145-3" title="3">}</a>
<a class="sourceLine" id="cb145-4" title="4">m&lt;-<span class="dv">10000</span></a>
<a class="sourceLine" id="cb145-5" title="5">x&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb145-6" title="6">x[<span class="dv">1</span>]&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb145-7" title="7">k&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb145-8" title="8">u&lt;-<span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb145-9" title="9"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb145-10" title="10">  xt&lt;-x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb145-11" title="11">  y&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,xt,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb145-12" title="12">  num&lt;-<span class="kw">f</span>(y)<span class="op">*</span><span class="kw">dnorm</span>(xt,y,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb145-13" title="13">  den&lt;-<span class="kw">f</span>(xt)<span class="op">*</span><span class="kw">dnorm</span>(y,xt,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb145-14" title="14">  <span class="cf">if</span>(u[i]<span class="op">&lt;=</span>(num<span class="op">/</span>den)) </a>
<a class="sourceLine" id="cb145-15" title="15">    x[i]&lt;-y</a>
<a class="sourceLine" id="cb145-16" title="16">  <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb145-17" title="17">    x[i]&lt;-xt</a>
<a class="sourceLine" id="cb145-18" title="18">    k&lt;-k<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb145-19" title="19">  }</a>
<a class="sourceLine" id="cb145-20" title="20">}</a>
<a class="sourceLine" id="cb145-21" title="21"><span class="kw">print</span>(k<span class="op">/</span>m)</a></code></pre></div>
<pre><code>## [1] 0.2279</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1">index&lt;-<span class="dv">1001</span><span class="op">:</span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb147-2" title="2">y1&lt;-x[index]</a>
<a class="sourceLine" id="cb147-3" title="3"><span class="kw">plot</span>(index,y1,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math display">\[F(x)=\int^x_{-\infty}f(t)dt=1/2+arctanx/\pi \]</span></p>
<p><span class="math display">\[F^{-1}(q)=tan(\pi(q-1/2))\]</span></p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1">a&lt;-<span class="kw">ppoints</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb148-2" title="2">QR&lt;-<span class="kw">tan</span>(pi<span class="op">*</span>(a<span class="fl">-0.5</span>))</a>
<a class="sourceLine" id="cb148-3" title="3">Q&lt;-<span class="kw">quantile</span>(y1,a)</a>
<a class="sourceLine" id="cb148-4" title="4"><span class="kw">qqplot</span>(QR,Q,<span class="dt">xlab=</span><span class="st">&quot;li lun&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;yang ben&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1"><span class="kw">hist</span>(y1,<span class="dt">freq =</span> <span class="ot">FALSE</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.35</span>))</a>
<a class="sourceLine" id="cb149-2" title="2"><span class="kw">lines</span>(QR,<span class="kw">f</span>(QR))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" title="1">a&lt;-<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb150-2" title="2">QRp&lt;-<span class="kw">tan</span>(pi<span class="op">*</span>(a<span class="fl">-0.5</span>))</a>
<a class="sourceLine" id="cb150-3" title="3">Qp&lt;-<span class="kw">quantile</span>(y1,a)</a>
<a class="sourceLine" id="cb150-4" title="4">QRp</a></code></pre></div>
<pre><code>## [1] -3.0776835 -1.3763819 -0.7265425 -0.3249197  0.0000000  0.3249197  0.7265425
## [8]  1.3763819  3.0776835</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1">Qp</a></code></pre></div>
<pre><code>##        10%        20%        30%        40%        50%        60%        70% 
## -3.0249121 -1.4642785 -0.8017586 -0.4290727 -0.1082778  0.2047738  0.5365800 
##        80%        90% 
##  1.0151406  2.0933415</code></pre>
</div>
<div id="section-10" class="section level1">
<h1>9.8</h1>
<p>a,b,n is 2,4,10</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1">N&lt;-<span class="dv">5000</span></a>
<a class="sourceLine" id="cb154-2" title="2">burn&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb154-3" title="3">X&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb154-4" title="4">a&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb154-5" title="5">b&lt;-<span class="dv">4</span></a>
<a class="sourceLine" id="cb154-6" title="6">n&lt;-<span class="dv">10</span></a>
<a class="sourceLine" id="cb154-7" title="7">X[<span class="dv">1</span>,]&lt;-<span class="kw">c</span>(<span class="dv">5</span>,<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb154-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb154-9" title="9">  x2&lt;-X[i<span class="dv">-1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb154-10" title="10">  X[i,<span class="dv">1</span>]&lt;-<span class="kw">rbinom</span>(<span class="dv">1</span>,n,x2)</a>
<a class="sourceLine" id="cb154-11" title="11">  x1&lt;-X[i,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb154-12" title="12">  X[i,<span class="dv">2</span>]&lt;-<span class="kw">rbeta</span>(<span class="dv">1</span>,x1<span class="op">+</span>a,n<span class="op">-</span>x1<span class="op">+</span>b)</a>
<a class="sourceLine" id="cb154-13" title="13">}</a>
<a class="sourceLine" id="cb154-14" title="14">X0&lt;-X[(burn<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N,]</a>
<a class="sourceLine" id="cb154-15" title="15"><span class="kw">plot</span>(X0,<span class="dt">cex=</span>.<span class="dv">5</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAYFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6ZrY6kNtmAABmZjpmZrZmkJBmtv+QOgCQZgCQ2/+2ZgC2Zjq2Zma2/7a2///bkDrb/7bb////tmb/25D//7b//9v///8QJrI/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIB0lEQVR4nO2da7ujJhRGPdMkbSdtJ520HXvM5f//y0G8RNHNCxHEy7s+zPM4GsR1NhtQTLInsZKlrsDSoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgMCCstWQSlDY4uJBQRJ17FCQQFbXkYIajGzTpJ8dC+obyYw6UZBhhIJGamAY6e/evaC0TeyaZcfHRZ3jW5DigmAf85mC4nbz+eFTOTo+n/fz1wDFBWFgwNyfjW5HEfS4KC3Fx/dnpWpqcWGQQgQcHkXQ/axaVvHlx7P5d1pxgRCyMNi94Qgyr9jMwim7+TYHaVWTi3uLQYQIBsDh2+3FBrcq7E1MOny74yB0L4eCpkXQXCPpPFkvJl2xsJ1KkFmK953MSafy2F6IoFjFjZ2BgtAp0MAwZZLWXbxCyEBxBHmNewYDRaHZRxooZvX4sMjmGyiCK15SBHXGzzNONcIKij9ZrYg5WRVuULRbvttmBSNPVisiRpCZZMzdC25iKgfVIRQzBw0ETYogqbRIvdj9XPViQvxEaWKOAxvXw2M2sXmKe3PkJ2+bFVy9IPtAZ9E5aJbiwkbQQPf6IyhyDlrDXAzM+XcvaJhk+rvDNrH1Cwp0xZ6HL1mQ7/R8CYKaAWCNeDfDsTi/j0SNIGlm5y2o+xxHmok6F+f5mTlzkHdF0wuaNwetcKC4kiSdZ/XjUumBjr2UFrejzc96bCcSlH98V+3s+HxTkFmc8Z9zjPw8D/cUVN0Ke1wOnxEEgX58FYKaJH09fG5c0JtJur2Zej1urYlJdRr7T8uBjRY1YgwvyDwmaQR5VLR3YHO7+XHZVgRJtw6WNA5aVg6yVHSUzQsKlINeqBGjXqb5HotrYmuIoMExzEHgmBUKijub38A4yE/Q7SStAh5P0lGTymC7X4lggrIugqDuUR6rO2YWlDIH1WsWlh1BSXux+7lctoAE2XPOKnOQw+rDmqsaJAFB84bETBGEVx82qCORIPP0G5iLOawda7mdfvGLoLSCLBV1YtDN40GQao3raWK2ijrhH0GwOLOJzStoGK9iRZ1ocxBafdjH+jLLJnsxuPrQXkrLSJ1mFtQ/ezBBgViAoCi9WJd/J99yTdrEJCNjFXU/8P5ns3072Xoxt5dZ0gpyw7ubr+8iXq1DabeXWdJ28474NjEVGscyfMp/RRxfRUjczbvhn4OK7OMPcDfa8WWWxBEUJQeVVEFkwzWCkgqS+vWRijrRHpiXEQSmGW4vs2xSkBon6m+9AeNop5dZttjEHHsxt+K22Iu5joOcituioC6TR9JbFzSJ+QUNck60bj4ICQQNaxCnmw8DBTkUl1YQm9h7SXmsomEPdC8usiCzzu/52rAgc/d717AjQRwH2ZvYOgRlLc/YgsycwyYGBz5M0kH6dQMKAlAQgIIAGxL0ZhYGUBBgQ4LYxNDhwStZlxr4QPfipgoKM5cArFnQmnOQ0/KXiYLiCDGJI2ie5S9Rco5JFEEzLV5Yr6B5lr+suIkxghBRlr8EugPmSaReLMbyl2EZq21ijsWlmTt4smRB84QIILYg27sai4wYk5kjKGuptsy9QU4SlJRNbBVQECDlZHUVJJusroYYgpxf3ESFgv3Tdk/9+ITDnV/93asgRhDC9dXf3QpyffV3v4ICFUpB0/ZTEAVN2799QVuCggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAcILKuy/GqAfrdm/Y+ZquWF5O2XWrzlqf+Vq9MO//XCoYZ/gggp17kI+/+Oi9uXWaywsd3QLtav6Fatxyl+5KiRD97N+FgNqaBBaUPXk4ypeQvVNwrYfELqfZUFV6fKnH5ejfPaieiKMamgQWhAWUGL7A+aHv0VBt1/tf3iboCL7qp/mudWwJbggfQnoK4Wv8n5VgJyDii//na0ZzNrEqmq51bAltKAqNkATtzxWKxuALCgvG0kVJmLRlgSsrTjV8EUKQYUlR5ePbC2CPsBfvwzN20nSvwRBDgFseyyrP24RpMuVvzIe5JclNDGcAnNrDqkXpwgGqsuSUzWIjiUkadiJ5vI4rkGOoGp9ifzXry5e3F8soJtHwzA5QbywjKTLFNVZZDL8KM5BiQeK6AfK6jZkrZ9tqlGAicrVtr8OLa+fUONkFUBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCLEzQ7VQ9l9drQOrVYrfTa1VnuZD3cfF4tD6ZhQmqV1fpBRrNKozOeqnOQt65WJogvYBFr0Js1/G8BNULefctqFwmnvdWgrWCmoW8+xakxPyljbRrCbtLEino2S5ibNcbUlAf1Ul1LFDQgOvhf/22CpvYOOWLBLqvHybpJwWVWvTrKMrASDdPQcqKNnA/q7HzyEBx94JUgq5k6Nc58maq8a19gWXvgkbREXT7vfM/FNRDCyq6q8MpqIeezf/zUrLv2fzioCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGAn7p1WtbkR+kTAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="more-1" class="section level1">
<h1>9.3more</h1>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" title="1"> Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</a>
<a class="sourceLine" id="cb155-2" title="2">        <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></a>
<a class="sourceLine" id="cb155-3" title="3">        <span class="co"># for chain in i-th row of X</span></a>
<a class="sourceLine" id="cb155-4" title="4">        psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</a>
<a class="sourceLine" id="cb155-5" title="5">        n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</a>
<a class="sourceLine" id="cb155-6" title="6">        k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</a>
<a class="sourceLine" id="cb155-7" title="7">        psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi)     <span class="co">#row means</span></a>
<a class="sourceLine" id="cb155-8" title="8">        B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)        <span class="co">#between variance est.</span></a>
<a class="sourceLine" id="cb155-9" title="9">        psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></a>
<a class="sourceLine" id="cb155-10" title="10">        W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)               <span class="co">#within est.</span></a>
<a class="sourceLine" id="cb155-11" title="11">        v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)     <span class="co">#upper variance est.</span></a>
<a class="sourceLine" id="cb155-12" title="12">        r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W             <span class="co">#G-R statistic</span></a>
<a class="sourceLine" id="cb155-13" title="13">        <span class="kw">return</span>(r.hat)</a>
<a class="sourceLine" id="cb155-14" title="14"> }</a>
<a class="sourceLine" id="cb155-15" title="15">chain1&lt;-<span class="cf">function</span>(m,<span class="dt">sigma=</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb155-16" title="16">f&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb155-17" title="17">  <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span>pi<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb155-18" title="18">}</a>
<a class="sourceLine" id="cb155-19" title="19">x&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb155-20" title="20">x[<span class="dv">1</span>]&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,sigma)</a>
<a class="sourceLine" id="cb155-21" title="21">u&lt;-<span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb155-22" title="22"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb155-23" title="23">  xt&lt;-x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb155-24" title="24">  y&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,xt,sigma)</a>
<a class="sourceLine" id="cb155-25" title="25">  num&lt;-<span class="kw">f</span>(y)<span class="op">*</span><span class="kw">dnorm</span>(xt,y,sigma)</a>
<a class="sourceLine" id="cb155-26" title="26">  den&lt;-<span class="kw">f</span>(xt)<span class="op">*</span><span class="kw">dnorm</span>(y,xt,sigma)</a>
<a class="sourceLine" id="cb155-27" title="27">  <span class="cf">if</span>(u[i]<span class="op">&lt;=</span>(num<span class="op">/</span>den)) </a>
<a class="sourceLine" id="cb155-28" title="28">    x[i]&lt;-y</a>
<a class="sourceLine" id="cb155-29" title="29">  <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb155-30" title="30">    x[i]&lt;-xt</a>
<a class="sourceLine" id="cb155-31" title="31">  }</a>
<a class="sourceLine" id="cb155-32" title="32">}</a>
<a class="sourceLine" id="cb155-33" title="33"><span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb155-34" title="34">}</a>
<a class="sourceLine" id="cb155-35" title="35">k&lt;-<span class="dv">4</span></a>
<a class="sourceLine" id="cb155-36" title="36">n&lt;-<span class="dv">10000</span></a>
<a class="sourceLine" id="cb155-37" title="37">b&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb155-38" title="38">X&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</a>
<a class="sourceLine" id="cb155-39" title="39"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</a>
<a class="sourceLine" id="cb155-40" title="40">  X[i, ] &lt;-<span class="st"> </span><span class="kw">chain1</span>(n,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb155-41" title="41">}</a>
<a class="sourceLine" id="cb155-42" title="42">  </a>
<a class="sourceLine" id="cb155-43" title="43"><span class="co">#trace plots</span></a>
<a class="sourceLine" id="cb155-44" title="44"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>n,X[<span class="dv">1</span>,],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a>
<a class="sourceLine" id="cb155-45" title="45"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span>n,X[<span class="dv">2</span>,],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb155-46" title="46"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span>n,X[<span class="dv">3</span>,],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb155-47" title="47"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span>n,X[<span class="dv">4</span>,],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1"><span class="co">#compute diagnostic statistics</span></a>
<a class="sourceLine" id="cb156-2" title="2">psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</a>
<a class="sourceLine" id="cb156-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</a>
<a class="sourceLine" id="cb156-4" title="4">    psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</a>
<a class="sourceLine" id="cb156-5" title="5"><span class="co">#plot psi for the four chains</span></a>
<a class="sourceLine" id="cb156-6" title="6"></a>
<a class="sourceLine" id="cb156-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb156-8" title="8">    <span class="kw">plot</span>((b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb156-9" title="9">            <span class="dt">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="dt">ylab=</span><span class="kw">bquote</span>(phi))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAmVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6Ojo6OmY6ZmY6ZrY6kNtmAABmADpmOgBmOjpmZjpmZmZmZpBmtrZmtv+QOgCQZmaQkGaQtraQttuQ2/+2ZgC2Zjq2tpC2tra2ttu229u22/+2/7a2///bkDrbkGbbtrbb/9vb////tmb/25D/27b/29v//7b//9v////QBQBrAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHnklEQVR4nO2cC3ujRBSGp9W2uurGS2tTdbNW3ca1VBP+/48TZoAAIXxzDSfwvc+2SxI4DG9gmGFOR+VkFDV1AaRDQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAkQWpi2EqQXHDpYOCABQEkCdImDqBgmQZoiAABQEoCEBBAGmC1MIFwRb80gXBcEqaIYGCZDUVKQhAQQAKAogUJMmQTEGCFEkUlFMQBW2LY3zUC9cvTuH0+/MXtL36kO9Wt7mvIEE3siSC9uv3+vfNq58gSXf6JIJ2K3155Zub1xBBIi60hGdQwebWUpDqnTozF9RcWLuVchDUakXLuZclu4uZi2y/thSkBgSJqKyFtIOUfg50EKKqJ0MU1LxUnV6Yeegooc+RWpB1Jd3rptZuZi+oH+XEM+laTktQzN0GIOYSO/x0VuhqmwBBgobXUxM/xk8kaL82F9KJGsheUD71OEeihqKqmtJZvQDCjUWfoaCmq1GoKjqsFuGSCQpuKSTtrBZk1rf503sOOUaZgiKfQerwpNr1YKsNHbeyLZnfiiV1VyxKHZSrqp3UU2RTovZTAT9Pie5iRTdec+L8cROU146qC8byeA/tUXXwmzdvWCK9HXT4vBZU19mgduk02A8dl3YEn4JGWNErnKWg+hDrpbEthj50z5+/OEHmlWqqJcv4/fftFV2KoO4RHQSppkZS7U/x8c9MUH+Nrhj9ry3I4gSZnaCj7Q/d/aH7PwW1Hx2pbh1lFWxRgnohZijIPfhxLTMPQScaIh7BjzZRzX+XLOhEuBjBG0F2wRIK+vz08KftVpb7jSLIrZWcTNDuh6t37+6+PPUo1TWcYynGItZ2Jhb08bfy978Pp7rpXvuNI6iKZCnIcp9OgvZP9z99c6/58dv7IEfxBbkGSSLo8/PvD8+ap1+f/xAmKKgEoav1LrH939+5l2hkv3MStF+rL+6UwEo6rAShq7VX/O/5+S+0tuPA4bwEWeA6cLg0Qc7DPksT5DxwuDRBPIMQrgOHixPkOnC4PEGO4UQIGu6dUVDzevhRSWpBdlmukwgaeCw+MKJ2sY9cI5Rl4OVg/q1XuFCkCGplZg+XRYAgj7yoeEWYSpBLZzU4S86TrqBTuUMCOqsT+dHjH62cqtb73bWsw9nj1tWYUFDrrnVWQdadVRWeZOlPnYilWgXqLh2/GgvnsGv7M8gM00wjqFuUswqy76yac3x6QZ38q6NPrcPYY9tZneoO1qY/n8pZBNmGEzEhl+oeHQX16SdAdj+0jhKrOJ1wIgT1yiBNUNy4XogWJI8xXWObRS5F3HBRoSAABQEoCEBBgCkFefw90vnhGQSgIAAFASgIQEEACkKcfvhhuRHGe6pSEaQX5D9VqQiSCwqYqlQEyQUFTFUqgjOdQbnDVKWy6EzzYb2Ryx6cpyqVRfuvzpLdxdymKpVHYkHnDhcfCgKcS9BFVtIlzlOBLu0Mch6YWp4gU0Q+cgUkEuQ6ValcEjUUXacqlUvarob1RJNySdpZzUeSOC+GFIIszqCA3eBVogRxPckd6yCUxBmwmzkIwkmcAbuZhSBvFiWoVRXF3A0FBa9CQecIQkERVglYvYSCSAsKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQESCNIj8DqPn+m1NWH4QXI251St2FB3r5+AQFQpCSC9utin9vy4LJiofwZWIBkN68m6dg/yG6lx+9GAsBISQS93ZXDQ9vrF/PoaHObHy9AzJpBQTKTRTASAEdKWAcVX0xj6ngBbv72VfW9egfJ1Hs9AjwSAEdKKGhT7F8fZDa0ADfPrj+tdEUWFuRlNACOlE5QOfpqru7i9/EC3H5bXh779W1QEH3oIwFwpGSCsrqO9hZ0VX258xRkRu9Drg5TMRSVxCwvsSrVKqSSNqUujiA4iMBK+pCR73+bN9lIWVhbIZN5m3+7q0fOQhqKZQ6SPoCAIJnMhuLWJMmU+93WLfnjBUhW91f8g1S1y0gAFImdVQAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIIE/QUSqBXapDKigIQEEAkYJ2q59XZmbvMjnllyqNpkyFKXPBdiv3v9v3R6igMlO/+NkUPjJVvSjTssqEKtfJncIQKui9Sd/UGYSb6g2dDZVdf/r+rFecUEGPOkexSaAz1ZD2tVEWqYkRES1o2wiqZmZ7LPPyHmGImIgW1DuDSvbre4vs34iIFlRlMVdvaLY3/3hMPhOAaEH65tXcxUxt/WiVYR8P2YK67aBCzEbnTp+zmpYnSBgUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBDgf3ZktPvuMBG3AAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" title="1">rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</a>
<a class="sourceLine" id="cb157-2" title="2"><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</a>
<a class="sourceLine" id="cb157-3" title="3">    rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</a>
<a class="sourceLine" id="cb157-4" title="4"><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</a>
<a class="sourceLine" id="cb157-5" title="5"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" title="1">n&lt;-<span class="dv">10000</span></a>
<a class="sourceLine" id="cb158-2" title="2">X&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</a>
<a class="sourceLine" id="cb158-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</a>
<a class="sourceLine" id="cb158-4" title="4">  X[i, ] &lt;-<span class="st"> </span><span class="kw">chain1</span>(n,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb158-5" title="5">}</a>
<a class="sourceLine" id="cb158-6" title="6">  </a>
<a class="sourceLine" id="cb158-7" title="7"><span class="co">#trace plots</span></a>
<a class="sourceLine" id="cb158-8" title="8"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>n,X[<span class="dv">1</span>,],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a>
<a class="sourceLine" id="cb158-9" title="9"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span>n,X[<span class="dv">2</span>,],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb158-10" title="10"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span>n,X[<span class="dv">3</span>,],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb158-11" title="11"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span>n,X[<span class="dv">4</span>,],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" title="1"><span class="co">#compute diagnostic statistics</span></a>
<a class="sourceLine" id="cb159-2" title="2">psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</a>
<a class="sourceLine" id="cb159-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</a>
<a class="sourceLine" id="cb159-4" title="4">    psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</a>
<a class="sourceLine" id="cb159-5" title="5"><span class="co">#plot psi for the four chains</span></a>
<a class="sourceLine" id="cb159-6" title="6"></a>
<a class="sourceLine" id="cb159-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb159-8" title="8">    <span class="kw">plot</span>((b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb159-9" title="9">            <span class="dt">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="dt">ylab=</span><span class="kw">bquote</span>(phi))</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAmVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6Ojo6OmY6ZmY6ZrY6kNtmAABmADpmOgBmOjpmZjpmZmZmZpBmtrZmtv+QOgCQZmaQkGaQtraQttuQ2/+2ZgC2Zjq2tpC2tra2ttu229u22/+2/7a2///bkDrbkGbbtrbb/9vb////tmb/25D/27b/29v//7b//9v////QBQBrAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAH0klEQVR4nO2dDXubNhSFlXSJt26L95EsybZ6y9qGdcGbzf//cQMJCJiPg6QrUPB5n6eN44iD/BoLsC+yysgoaukOxA4FASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgIIC1JvhqUEycaFg4IAFAR4G4IW1PlGBC1niILQqsUbBoiz2NmKQ0Fo3eIN5eNyPSpIJyatXLyhfFwhSJW3ZlcUp6C2CFW1tznylyJKQe2zIFUKUq9b0ozEL8j8VOXmQ0H1H1VrYK6E9SznvVWVz4beQMsnojHsTU7x7IVFXKtrbU/9gvwUtd7b6LzREaGgumsqa2weg4J8R6bXTbNOqfcK4x09yfHog12cam40p49dnTZVqnOvd09Od6GuOT4MxbV2XxkQpKpDSGFBFn92aOgX1xxQVN8ArBoN1emdkj2xjZ5LUOMvSvU06x0bzkpQ6xcKGr2/b//dOnxEaT49sY1eQlDf/rt3d78eQfDjJvjAVy4IxsHVUNCkBRUFjS84enwt0xPb6JgEdYYwCmo3oCCwYGcfSEGtBsMnaJI9sY2OSZD9Ug49sY2ORtDI+YdoT2yj4xHkspRDT2yj1yoILUpBnn+X6INN3NRzMcul7DtiHR2LIMGlJi1KQVLRLn3Yb+5t485D0GH7+sbY5bNV3HkIylJ1U/zgFjTIYXv1QkGj7C4+UNAoibqhoFH2m3cUNMrxQVGQKxRUkvA4yA0Kcoxbg6Avj3cfnbtj99n85FjX/gQQdPjx4v37zVf9I0tNvgMbOxNb8xb0x+/F///evYw1Tsy5WH1SNn29b1vQ8fH2529vNT99dzvs6PhQa0mu+lutVNCXpz/vnjSPvz39NSjosK0PENNZdvMehsK8xI5/fz/W1nULUmsQlA+/7zYKDNJJdY5hNwatQlCW/ff09Am1rt5THNh+1i1IhH5BfXW/7nEiS4Y9mx94fQ3FURCIoyAQR0EgjoJA3LkJso1TGQWNxSkKGo+jIBBHQf1x1S0zbQAFdeJaF4HPLgheUX72gsSSAwlqTwExn6CTCR0EkkMJUs1NZy5BjalTxJKDClJzC8oaM1IIJa9JkFnltEktlheUvfZ2NkH1DzwtysKCGjPSmHvnEPQ6ddOEaWNmFnT60bOqZzUqVzKDoPbcX2LJgbagcjv3neXOYjHLVSwuqP2r61pWL6i6N7gg6210WUFiVy9PW9BlMq+ld/NCK5k03DrNBndWglzyz0aQ6w7yXATNMPw7riCGOLfRZ0qyS8Po4vxm6ly/IM+pXtcuyPnsDiY7N4wqznci3JULarxPIJzs0zCiODXpLTGXZJ+Gmp1S17rafuiCsTkEtedblkz2alhQFP/u1HVRzGlZae9I70mvklhREEG6MCi9+JDZV9o70oor346X+YKAIIJ0pb2psbettHekGScwCfdAskzDbMktqDSj5L6iJPAYNFiFF05Q+aGXdLJcQ81Ce7HqmzfiF7RMnMSBYX+yZMPl4kav9fRKFm3YxvaycEfqY2ZpP2vZguoPLChoKC/U90bNLAheFu4eLBxYB4s31DhfFh4dgQ4UnS8Lj45wpxqGmU41whHuZNUw08lqOBbbgt4MIQRNuCzcYzW4iUiI7UZu1xxeFu6xmlUIcuasBI1dkumxGgrybkJBc4RQkEATj+YFFBQAClotFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCBBGkP6IWr8pkiqlixp7bkD2G1XU+/mE7L95BgEoKYig40O+zqR4cEXJpy777N6ApFcv2WHrFXLYmprc4QCYFESQ+fKf5PLZvLe2u866NyCmpVdIasosRgJwUsAxKH9ialPdG3Dx/dfl8+ockqob/RH5SABOCihol69fP8i07wZcPL38vNUDmV/I82gATgonqPh42ry68/+7N+DySfHyOD5ce4Xohz4SgJOCCUqrMdpZ0EX55K5TkClv8Hl1mIEhHyRW+RJLml8X6TZIm17nj8A7JMJBuqqT8dnNm3Kt1O9YIY1zN7/fVB8t+hwoFkVa9QVGjiFpnAeKiakiKtabVEfy3RuQtDpfcQ8pR5eRAJTEk1UABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCBCfoE4pwbRSh1BQEICCAFEKOmx/2Zr5YovilF/LMpqiFKaoBRuc7TsIkQoqKvXzf7vcR6rKX4qyrKKgamj2qzBEKujGlG/qCsJdeYeuhkovP/8w6ysuUkH3ukaxLqAzw5D2tVMTShMFiVpQUgsqZ2YrpowfnMs6DFELOtmCCo4PtxOqfwWJWlBZxVzeoUmu/nGYnceDqAXpnVe9FzOj9f2kCns54hbUPg7Kxex07fScw3R8giKDggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoC/A/gFa+ildjrHgAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" title="1">rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</a>
<a class="sourceLine" id="cb160-2" title="2"><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</a>
<a class="sourceLine" id="cb160-3" title="3">    rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</a>
<a class="sourceLine" id="cb160-4" title="4"><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</a>
<a class="sourceLine" id="cb160-5" title="5"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="more-2" class="section level1">
<h1>9.8more</h1>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" title="1">chain2&lt;-<span class="cf">function</span>(a,b,n,N){</a>
<a class="sourceLine" id="cb161-2" title="2">A&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb161-3" title="3">B&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb161-4" title="4">A[<span class="dv">1</span>]&lt;-n<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb161-5" title="5">B[<span class="dv">1</span>]&lt;-<span class="fl">0.5</span></a>
<a class="sourceLine" id="cb161-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb161-7" title="7">  x2&lt;-B[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb161-8" title="8">  A[i]&lt;-<span class="kw">rbinom</span>(<span class="dv">1</span>,n,x2)</a>
<a class="sourceLine" id="cb161-9" title="9">  x1&lt;-A[i]</a>
<a class="sourceLine" id="cb161-10" title="10">  B[i]&lt;-<span class="kw">rbeta</span>(<span class="dv">1</span>,x1<span class="op">+</span>a,n<span class="op">-</span>x1<span class="op">+</span>b)</a>
<a class="sourceLine" id="cb161-11" title="11">}</a>
<a class="sourceLine" id="cb161-12" title="12"><span class="kw">return</span>(A)</a>
<a class="sourceLine" id="cb161-13" title="13">}</a>
<a class="sourceLine" id="cb161-14" title="14">k&lt;-<span class="dv">4</span></a>
<a class="sourceLine" id="cb161-15" title="15">n&lt;-<span class="dv">5000</span></a>
<a class="sourceLine" id="cb161-16" title="16">b&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb161-17" title="17">X&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</a>
<a class="sourceLine" id="cb161-18" title="18"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</a>
<a class="sourceLine" id="cb161-19" title="19">  X[i, ] &lt;-<span class="st"> </span><span class="kw">chain2</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">10</span>,n)</a>
<a class="sourceLine" id="cb161-20" title="20">}</a>
<a class="sourceLine" id="cb161-21" title="21">  </a>
<a class="sourceLine" id="cb161-22" title="22"><span class="co">#trace plots</span></a>
<a class="sourceLine" id="cb161-23" title="23"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>n,X[<span class="dv">1</span>,],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" title="1"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>n,X[<span class="dv">2</span>,],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" title="1"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>n,X[<span class="dv">3</span>,],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" title="1"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>n,X[<span class="dv">4</span>,],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" title="1"><span class="co">#compute diagnostic statistics</span></a>
<a class="sourceLine" id="cb165-2" title="2">psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</a>
<a class="sourceLine" id="cb165-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</a>
<a class="sourceLine" id="cb165-4" title="4">    psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</a>
<a class="sourceLine" id="cb165-5" title="5"><span class="co">#plot psi for the four chains</span></a>
<a class="sourceLine" id="cb165-6" title="6"></a>
<a class="sourceLine" id="cb165-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb165-8" title="8">    <span class="kw">plot</span>((b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb165-9" title="9">            <span class="dt">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="dt">ylab=</span><span class="kw">bquote</span>(phi))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" title="1">rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</a>
<a class="sourceLine" id="cb166-2" title="2"><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</a>
<a class="sourceLine" id="cb166-3" title="3">    rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</a>
<a class="sourceLine" id="cb166-4" title="4"><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</a>
<a class="sourceLine" id="cb166-5" title="5"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAATlBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6ZmY6kNtmAABmtv+QOgCQ2/+2ZgC2///bkDrbkJDb////tmb/25D//7b//9v////lwOCVAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGeUlEQVR4nO2d7XraOBBG3W2b/UhKU1on5P5vdLFNKCnIR5Jn8Aje88t5oozMyViSZQl3b2KWbu0TiI4EARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIElAnabbqRv344nU48igRtu8fpoH8/uH1KBO02Ry3bL78cTiYiJYJen769H/Z3c5Epg4DCNuiQQmqDErw+Tb3Y3eSPxkGIBAFlvdgdXVrvlAn67wEa564ZfAQ97juyr1bhVsVN0NDFzziSoJE+ebsqQYkoxZd2CR6BryyoKhxE+tigVjax6fDmBa8bDhwsl9S2oKxPv0yRt6CtZyOd+8mXGGo4g0oGcfWK2hVU9pmrDbUqqDgnapOoTUFVn7bOUJOCapOh5s+cBoq/R2oOvVh9e1Lxlz4ZtNvQw4wlHe9V/9bpEtttZic7lghaNjIub9zNC0703bfZ39ePSwz6v5IQrTXSJnfrJYoaE2Q1m5GvqC1BhrM9uYquLGjhRI3pfynvLJrKIPNpyAxHLQlymaeldG5IkM889hQ5HbolQbZn8DF2UlE7gvwS6BD+cvxmBDn7eUspakWQv5+3yw12M4Jsq5+p6A9JjQi6SgKd1Pa7ujYEXdfPVOOhykYE2VaeV2dXVvWagq6fQCd1mxd0CLeinyYErZlAbQiyrbqMBgStmkAtTJit6qeBDFo3gZxXuaZ3HDo8VvDBT9C4Eepk51htvbcq6KAmtV9srUu7GDdBLw+joNSOw+zHUjcryCiD1vbjufzl69vMiunMcKsnkFtbsHf06fvMjsxcQWW1OhB7HLS+HwkyO4U1Borrt0CLBP1MrrKzGigG8FMuaHtIi7lliEbdfIQEKhbU7/um5/2H3l8/6S1PRgPFCH5KBY2LM/fJsR068SQ2GRTCT6mgsXXZbf6d37GbHigWzAeFuMAqBA158czfyLF8oBjDT6Wg5d8bgPUGSaBKQbBK3KDeKH7cBdXuOIziJ2oGhUmgckG4j8ek3jB+gt6sxkmgqIJsK1uCBAGOU671Ow4D+XHKoIU7Dm9f0LIdh5H8uLVBS3Yc3oWgBeEC9fFvMQXZ1rSQeIJiJVDABVSx/MTLoGAJFFCQbT2LiSYoWgJFExTOTzBB8fxEE2RbiQWhBAVMoFCCIvqJJci2ChsCCQqZQIEExfQTSZBtBVZIEBBGUFA/EkREERS0iY4zYRbVT5QMCptAYQTZRjfE7cEhLJH5GC5uAjkJ4pdAdjM/hcJFUMYr/D6EC5xAXqs78CWQXfKHYETIoMgJ5NYG0Usgu8RxOJx6MXwJ5Em40AkUYBwU208EQbaBrXEVdNgzNhsueAKtv4gzuB+nDDp0XhkZFD2B/Hqxof/KEVQUdgXc2qDnT98zBIVPIMdGen/Dei7ozwmz8H48e7GXh8+cQcVRr41nN7/bpBdLT+HiX2EBBorB8Rbk+hLIa6AMAiQIWE1QM6wkqCxoZrlVilUWtw16a4KyN4/fq6CMLZllQW9OEG/JLAt6e4JwS2ZZ0BsUZBtUgmzKSVDEYpXF7w8JAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggB7QX0387XmL//8+FDm/CCfbTpIRbQU5oKGb8fvU2f3+jROah/LnB/kMzz9TgSpiJbEWtC0Gj/xvcL99DTkWOb8IJ/Dt8xfClIRLY21oGlx1eW1DX33OO7xOJY5PyisbRBkF+0i5oL+HjI7tddl+sWxzPlBYW3bYUGgWbSLWAuaLv1kAzCe9bHM+UFZXeNLQKyiJWhZ0HCJffnVmKDrXmKDhcYuMWggjRvpIVRjjTR0sb1ZNz9Z2MdrrJuHQVpvN1AcXpMyqmhroHhyB3CJQ8NwLHN+kM9z100rBUyipdDNKiBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQB/wN5FBIADwcRUAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" title="1">chain2&lt;-<span class="cf">function</span>(a,b,n,N){</a>
<a class="sourceLine" id="cb167-2" title="2">A&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb167-3" title="3">B&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb167-4" title="4">A[<span class="dv">1</span>]&lt;-n<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb167-5" title="5">B[<span class="dv">1</span>]&lt;-<span class="fl">0.5</span></a>
<a class="sourceLine" id="cb167-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb167-7" title="7">  x2&lt;-B[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb167-8" title="8">  A[i]&lt;-<span class="kw">rbinom</span>(<span class="dv">1</span>,n,x2)</a>
<a class="sourceLine" id="cb167-9" title="9">  x1&lt;-A[i]</a>
<a class="sourceLine" id="cb167-10" title="10">  B[i]&lt;-<span class="kw">rbeta</span>(<span class="dv">1</span>,x1<span class="op">+</span>a,n<span class="op">-</span>x1<span class="op">+</span>b)</a>
<a class="sourceLine" id="cb167-11" title="11">}</a>
<a class="sourceLine" id="cb167-12" title="12"><span class="kw">return</span>(B)</a>
<a class="sourceLine" id="cb167-13" title="13">}</a>
<a class="sourceLine" id="cb167-14" title="14">k&lt;-<span class="dv">4</span></a>
<a class="sourceLine" id="cb167-15" title="15">n&lt;-<span class="dv">5000</span></a>
<a class="sourceLine" id="cb167-16" title="16">b&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb167-17" title="17">X&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</a>
<a class="sourceLine" id="cb167-18" title="18"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</a>
<a class="sourceLine" id="cb167-19" title="19">  X[i, ] &lt;-<span class="st"> </span><span class="kw">chain2</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">10</span>,n)</a>
<a class="sourceLine" id="cb167-20" title="20">}</a>
<a class="sourceLine" id="cb167-21" title="21">  </a>
<a class="sourceLine" id="cb167-22" title="22"><span class="co">#trace plots</span></a>
<a class="sourceLine" id="cb167-23" title="23"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>n,X[<span class="dv">1</span>,],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" title="1"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>n,X[<span class="dv">2</span>,],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" title="1"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>n,X[<span class="dv">3</span>,],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" title="1"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>n,X[<span class="dv">4</span>,],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" title="1"><span class="co">#compute diagnostic statistics</span></a>
<a class="sourceLine" id="cb171-2" title="2">psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</a>
<a class="sourceLine" id="cb171-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</a>
<a class="sourceLine" id="cb171-4" title="4">    psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</a>
<a class="sourceLine" id="cb171-5" title="5"><span class="co">#plot psi for the four chains</span></a>
<a class="sourceLine" id="cb171-6" title="6"></a>
<a class="sourceLine" id="cb171-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb171-8" title="8">    <span class="kw">plot</span>((b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb171-9" title="9">            <span class="dt">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="dt">ylab=</span><span class="kw">bquote</span>(phi))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" title="1">rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</a>
<a class="sourceLine" id="cb172-2" title="2"><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</a>
<a class="sourceLine" id="cb172-3" title="3">    rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</a>
<a class="sourceLine" id="cb172-4" title="4"><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</a>
<a class="sourceLine" id="cb172-5" title="5"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-11" class="section level1">
<h1>11.3</h1>
<div id="a-1" class="section level2">
<h2>(a)</h2>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb173-2" title="2">kth&lt;-<span class="cf">function</span>(a,k,d){</a>
<a class="sourceLine" id="cb173-3" title="3">  s&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb173-4" title="4">  <span class="cf">if</span>(k<span class="op">%%</span><span class="dv">2</span><span class="op">==</span><span class="dv">1</span>) s&lt;-<span class="op">-</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb173-5" title="5">  g&lt;-<span class="kw">exp</span>(<span class="kw">lgamma</span>((d<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">lgamma</span>(k<span class="op">+</span><span class="dv">3</span><span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">+</span>d<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb173-6" title="6">  e&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb173-7" title="7">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d){</a>
<a class="sourceLine" id="cb173-8" title="8">    e&lt;-e<span class="op">+</span>a[j]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb173-9" title="9">  }</a>
<a class="sourceLine" id="cb173-10" title="10">  f&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb173-11" title="11">  fac&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb173-12" title="12">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>k){</a>
<a class="sourceLine" id="cb173-13" title="13">    fac&lt;-fac<span class="op">+</span><span class="kw">log</span>(i)</a>
<a class="sourceLine" id="cb173-14" title="14">  }</a>
<a class="sourceLine" id="cb173-15" title="15">  f&lt;-(k<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">log</span>(e)<span class="op">-</span>fac<span class="op">-</span>k<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb173-16" title="16">  f&lt;-<span class="kw">exp</span>(f)</a>
<a class="sourceLine" id="cb173-17" title="17">  f&lt;-f<span class="op">*</span>s<span class="op">*</span>g<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb173-18" title="18">  <span class="kw">return</span>(f)</a>
<a class="sourceLine" id="cb173-19" title="19">}</a>
<a class="sourceLine" id="cb173-20" title="20">k&lt;-<span class="dv">10</span></a>
<a class="sourceLine" id="cb173-21" title="21">d&lt;-<span class="dv">10</span></a>
<a class="sourceLine" id="cb173-22" title="22">a&lt;-<span class="kw">runif</span>(d,<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb173-23" title="23"><span class="kw">kth</span>(a,k,d)</a></code></pre></div>
<pre><code>## [1] 155500.1</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" title="1">a&lt;-<span class="kw">runif</span>(d,<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb175-2" title="2"><span class="kw">kth</span>(a,k,d)</a></code></pre></div>
<pre><code>## [1] 11.28007</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" title="1">k&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb177-2" title="2">d&lt;-<span class="dv">10</span></a>
<a class="sourceLine" id="cb177-3" title="3">a&lt;-<span class="kw">runif</span>(d,<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb177-4" title="4"><span class="kw">kth</span>(a,k,d)</a></code></pre></div>
<pre><code>## [1] 4.522363e-35</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" title="1">a&lt;-<span class="kw">runif</span>(d,<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb179-2" title="2"><span class="kw">kth</span>(a,k,d)</a></code></pre></div>
<pre><code>## [1] 1.513206e-46</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" title="1">k&lt;-<span class="dv">10</span></a>
<a class="sourceLine" id="cb181-2" title="2">d&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb181-3" title="3">a&lt;-<span class="kw">runif</span>(d,<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb181-4" title="4"><span class="kw">kth</span>(a,k,d)</a></code></pre></div>
<pre><code>## [1] 0.0009048536</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" title="1">a&lt;-<span class="kw">runif</span>(d,<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb183-2" title="2"><span class="kw">kth</span>(a,k,d)</a></code></pre></div>
<pre><code>## [1] 0.002430449</code></pre>
</div>
<div id="b-1" class="section level2">
<h2>(b)</h2>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" title="1">kths&lt;-<span class="cf">function</span>(a,kk,d){</a>
<a class="sourceLine" id="cb185-2" title="2">  ff&lt;-<span class="kw">c</span>(<span class="dt">length=</span>kk)</a>
<a class="sourceLine" id="cb185-3" title="3">  e&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb185-4" title="4">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d){</a>
<a class="sourceLine" id="cb185-5" title="5">      e&lt;-e<span class="op">+</span>a[j]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb185-6" title="6">    }</a>
<a class="sourceLine" id="cb185-7" title="7">  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>kk){</a>
<a class="sourceLine" id="cb185-8" title="8">    s&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb185-9" title="9">    <span class="cf">if</span>(k<span class="op">%%</span><span class="dv">2</span><span class="op">==</span><span class="dv">1</span>) s&lt;-<span class="op">-</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb185-10" title="10">    g&lt;-<span class="kw">exp</span>(<span class="kw">lgamma</span>((d<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">lgamma</span>(k<span class="op">+</span><span class="dv">3</span><span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">+</span>d<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb185-11" title="11">    f&lt;-e<span class="op">*</span>g</a>
<a class="sourceLine" id="cb185-12" title="12">    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</a>
<a class="sourceLine" id="cb185-13" title="13">      f&lt;-f<span class="op">*</span>e<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>i)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb185-14" title="14">    }</a>
<a class="sourceLine" id="cb185-15" title="15">    ff[k]&lt;-f<span class="op">*</span>s<span class="op">/</span>((<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb185-16" title="16">  }</a>
<a class="sourceLine" id="cb185-17" title="17">  <span class="kw">return</span>(<span class="kw">sum</span>(ff)<span class="op">+</span>e<span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="kw">lgamma</span>((d<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">lgamma</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(d<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb185-18" title="18">}</a>
<a class="sourceLine" id="cb185-19" title="19"></a>
<a class="sourceLine" id="cb185-20" title="20">k&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb185-21" title="21">d&lt;-<span class="dv">5</span></a>
<a class="sourceLine" id="cb185-22" title="22">a&lt;-<span class="kw">runif</span>(d,<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb185-23" title="23"><span class="kw">kths</span>(a,k,d)</a></code></pre></div>
<pre><code>## [1] 2.216767</code></pre>
</div>
<div id="c" class="section level2">
<h2>(c)</h2>
<p><span class="math inline">\(a=(1,2)^T\)</span></p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" title="1">d&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb187-2" title="2">k&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb187-3" title="3">a&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb187-4" title="4"><span class="kw">kths</span>(a,k,d)</a></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
</div>
</div>
<div id="section-12" class="section level1">
<h1>11.5</h1>
<div id="section-13" class="section level2">
<h2>11.4</h2>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" title="1">Sk&lt;-<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb189-2" title="2">  ri1&lt;-<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb189-3" title="3">  y1&lt;-<span class="kw">pt</span>(ri1,k<span class="dv">-1</span>,<span class="dv">0</span>,<span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb189-4" title="4">  ri2&lt;-<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb189-5" title="5">  y2&lt;-<span class="kw">pt</span>(ri2,k,<span class="dv">0</span>,<span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb189-6" title="6">  y1<span class="op">-</span>y2</a>
<a class="sourceLine" id="cb189-7" title="7">}</a>
<a class="sourceLine" id="cb189-8" title="8">k&lt;-<span class="dv">25</span></a>
<a class="sourceLine" id="cb189-9" title="9"><span class="kw">uniroot</span>(Sk,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="kw">sqrt</span>(k)))</a></code></pre></div>
<pre><code>## $root
## [1] 1.687318
## 
## $f.root
## [1] 7.358151e-09
## 
## $iter
## [1] 9
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 6.103516e-05</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" title="1">k&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb191-2" title="2"><span class="kw">uniroot</span>(Sk,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="kw">sqrt</span>(k)))</a></code></pre></div>
<pre><code>## $root
## [1] 1.720603
## 
## $f.root
## [1] -4.891514e-11
## 
## $iter
## [1] 10
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 6.103516e-05</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" title="1">k&lt;-<span class="dv">500</span></a>
<a class="sourceLine" id="cb193-2" title="2"><span class="kw">uniroot</span>(Sk,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">3</span>))</a></code></pre></div>
<pre><code>## $root
## [1] 1.729745
## 
## $f.root
## [1] 2.267631e-14
## 
## $iter
## [1] 7
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 6.103516e-05</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" title="1">k&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb195-2" title="2"><span class="kw">uniroot</span>(Sk,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">3</span>))</a></code></pre></div>
<pre><code>## $root
## [1] 1.730897
## 
## $f.root
## [1] 7.549517e-15
## 
## $iter
## [1] 7
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 6.103516e-05</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" title="1">k&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb197-2" title="2">a&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">sqrt</span>(k),<span class="dt">length.out =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb197-3" title="3">ri1&lt;-<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb197-4" title="4">y1&lt;-<span class="kw">pt</span>(ri1,k<span class="dv">-1</span>,<span class="dv">0</span>,<span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb197-5" title="5">ri2&lt;-<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb197-6" title="6">y2&lt;-<span class="kw">pt</span>(ri2,k,<span class="dv">0</span>,<span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb197-7" title="7"><span class="kw">plot</span>(a,y1<span class="op">-</span>y2,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-14" class="section level2">
<h2>11.5</h2>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" title="1">k&lt;-<span class="dv">25</span></a>
<a class="sourceLine" id="cb198-2" title="2">S1&lt;-<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb198-3" title="3">  f1&lt;-<span class="cf">function</span>(x) (<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb198-4" title="4">  b1&lt;-<span class="kw">integrate</span>(f1,<span class="dv">0</span>,<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))<span class="op">$</span>value</a>
<a class="sourceLine" id="cb198-5" title="5">  c1&lt;-<span class="kw">exp</span>(<span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2-1</span><span class="op">/</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(k<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb198-6" title="6">  f2&lt;-<span class="cf">function</span>(x) (<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2-1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb198-7" title="7">  b2&lt;-<span class="kw">integrate</span>(f2,<span class="dv">0</span>,<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))<span class="op">$</span>value</a>
<a class="sourceLine" id="cb198-8" title="8">  c2&lt;-<span class="kw">exp</span>(<span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(k)</a>
<a class="sourceLine" id="cb198-9" title="9">  b1<span class="op">*</span>c1<span class="op">-</span>b2<span class="op">*</span>c2</a>
<a class="sourceLine" id="cb198-10" title="10">}</a>
<a class="sourceLine" id="cb198-11" title="11"><span class="kw">uniroot</span>(S1,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">3</span>))</a></code></pre></div>
<pre><code>## $root
## [1] 1.687348
## 
## $f.root
## [1] 4.449131e-10
## 
## $iter
## [1] 7
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 6.103516e-05</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" title="1">k&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb200-2" title="2"><span class="kw">uniroot</span>(S1,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">3</span>))</a></code></pre></div>
<pre><code>## $root
## [1] 1.720626
## 
## $f.root
## [1] 6.747034e-10
## 
## $iter
## [1] 6
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 6.103516e-05</code></pre>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" title="1">k&lt;-<span class="dv">500</span></a>
<a class="sourceLine" id="cb202-2" title="2"><span class="kw">uniroot</span>(S1,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">3</span>))</a></code></pre></div>
<pre><code>## $root
## [1] 1.729745
## 
## $f.root
## [1] -3.18634e-14
## 
## $iter
## [1] 7
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 6.103516e-05</code></pre>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb204-1" title="1">k&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb204-2" title="2"><span class="kw">uniroot</span>(S1,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">3</span>))</a></code></pre></div>
<pre><code>## $root
## [1] 1.730897
## 
## $f.root
## [1] -1.887379e-15
## 
## $iter
## [1] 7
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 6.103516e-05</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" title="1">a&lt;-<span class="kw">seq</span>(<span class="fl">0.01</span>,<span class="dv">5</span>,<span class="dt">length.out =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb206-2" title="2">d&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb206-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){</a>
<a class="sourceLine" id="cb206-4" title="4">  f1&lt;-<span class="cf">function</span>(x) (<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb206-5" title="5">  b1&lt;-<span class="kw">integrate</span>(f1,<span class="dv">0</span>,<span class="kw">sqrt</span>(a[i]<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a[i]<span class="op">^</span><span class="dv">2</span>)))<span class="op">$</span>value</a>
<a class="sourceLine" id="cb206-6" title="6">  c1&lt;-<span class="kw">exp</span>(<span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2-1</span><span class="op">/</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(k<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb206-7" title="7">  f2&lt;-<span class="cf">function</span>(x) (<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2-1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb206-8" title="8">  b2&lt;-<span class="kw">integrate</span>(f2,<span class="dv">0</span>,<span class="kw">sqrt</span>(a[i]<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a[i]<span class="op">^</span><span class="dv">2</span>)))<span class="op">$</span>value</a>
<a class="sourceLine" id="cb206-9" title="9">  c2&lt;-<span class="kw">exp</span>(<span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(k)</a>
<a class="sourceLine" id="cb206-10" title="10">  d[i]&lt;-b1<span class="op">*</span>c1<span class="op">-</span>b2<span class="op">*</span>c2</a>
<a class="sourceLine" id="cb206-11" title="11">}</a>
<a class="sourceLine" id="cb206-12" title="12"><span class="kw">plot</span>(a,d,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="e-m" class="section level1">
<h1>E-M</h1>
<p><span class="math display">\[f(t)=\frac{1}{\lambda}\exp(-\frac{t}{\lambda}),t&gt;0\]</span> 。 <span class="math display">\[f(t_1,...,t_n)=\frac{1}{\lambda^n}\exp(-\frac{\sum_{i=1}^n t_i}{\lambda})=\frac{1}{\lambda^n}\exp(-\frac{\sum_{i=1}^m x_i+\sum_{j=1}^{n-m}y_j}{\lambda})\]</span> <span class="math display">\[Q(\lambda,\hat\lambda^{(i)})=E[-n\ln\lambda-\frac{\sum_{i=1}^m x_i+\sum_{j=1}^{n-m}y_j}{\lambda}|T_i,\hat\lambda^{(i)}]\]</span></p>
<p><span class="math display">\[0=E[-n/\lambda+(\sum_{i=1}^m x_i+\sum_{j=1}^{n-m}y_j)/\lambda^2|T_i,\hat\lambda^{(i)}]\]</span> <span class="math display">\[0=-n/\lambda+\sum_{i=1}^m x_i/\lambda^2+E[\sum_{j=1}^{n-m}y_j/\lambda^2|T_i,\hat\lambda^{(i)}]\]</span> <span class="math display">\[\hat\lambda^{(i+1)}=\frac{\sum_{i=1}^mx_i+E[\sum_{j=1}^{n-m}y_j|T_i,\hat\lambda^{(i)}]}{n}\]</span></p>
<p><span class="math display">\[E[\sum_{j=1}^{n-m}y_j|T_i,\hat\lambda^{(i)}]=(n-m)E[Z],f(z)=\frac{\frac{1}{\lambda}\exp(-\frac{z}{\lambda})}{\exp(-\tau/\lambda)},z&gt;\tau\]</span> <span class="math display">\[E[Z]=\int_\tau^\infty\frac{\frac{z}{\lambda}\exp(-\frac{z}{\lambda})}{\exp(-\tau/\lambda)}dz=\frac{-z\exp(-z/\lambda)-\lambda\exp(-z/\lambda)|_\tau^\infty}{\exp(-\tau/\lambda)}=\frac{(\tau+\lambda)\exp(-\tau/\lambda)}{\exp(-\tau/\lambda)}=\tau+\lambda\]</span> <span class="math display">\[\hat\lambda^{(i+1)}=\frac{\sum_{i=1}^mx_i+(n-m)(\tau+\hat\lambda^{(i)})}{n}=\frac{\sum_{i=1}^ny_i+(n-m)(\hat\lambda^{(i)})}{n}\]</span></p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" title="1">y&lt;-<span class="kw">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>,<span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.91</span>,<span class="dv">1</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>)</a>
<a class="sourceLine" id="cb207-2" title="2">tau&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb207-3" title="3">EM&lt;-<span class="cf">function</span>(<span class="dt">tau=</span><span class="dv">1</span>,y,<span class="dt">max.it=</span><span class="dv">10000</span>,<span class="dt">eps=</span><span class="fl">1e-5</span>){</a>
<a class="sourceLine" id="cb207-4" title="4">  lam2&lt;-<span class="fl">0.1</span></a>
<a class="sourceLine" id="cb207-5" title="5">  lam1&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb207-6" title="6">  n&lt;-<span class="kw">length</span>(y)</a>
<a class="sourceLine" id="cb207-7" title="7">  e=y[<span class="kw">which</span>(y[]<span class="op">==</span><span class="dv">1</span>)]</a>
<a class="sourceLine" id="cb207-8" title="8">  m&lt;-<span class="kw">length</span>(e)</a>
<a class="sourceLine" id="cb207-9" title="9">  <span class="cf">while</span>(<span class="kw">abs</span>(lam1<span class="op">-</span>lam2)<span class="op">&gt;=</span>eps){</a>
<a class="sourceLine" id="cb207-10" title="10">    lam1&lt;-lam2</a>
<a class="sourceLine" id="cb207-11" title="11">    lam2&lt;-(<span class="kw">sum</span>(y)<span class="op">-</span>m<span class="op">+</span>m<span class="op">*</span>(tau<span class="op">+</span>lam2))<span class="op">/</span>n</a>
<a class="sourceLine" id="cb207-12" title="12">    <span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">c</span>(lam2),<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb207-13" title="13">    <span class="cf">if</span>(i<span class="op">==</span>max.it) <span class="cf">break</span></a>
<a class="sourceLine" id="cb207-14" title="14">    i&lt;-i<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb207-15" title="15">  }</a>
<a class="sourceLine" id="cb207-16" title="16">  <span class="kw">return</span>(lam2)</a>
<a class="sourceLine" id="cb207-17" title="17">}</a>
<a class="sourceLine" id="cb207-18" title="18"><span class="kw">EM</span>(<span class="dv">1</span>,y)</a></code></pre></div>
<pre><code>## [1] 0.705
## [1] 0.8865
## [1] 0.94095
## [1] 0.95729
## [1] 0.96219
## [1] 0.96366
## [1] 0.9641
## [1] 0.96423
## [1] 0.96427
## [1] 0.96428
## [1] 0.96428</code></pre>
<pre><code>## [1] 0.9642842</code></pre>
<p>： <span class="math display">\[\hat\lambda^{(i+1)}=\frac{\sum_{i=1}^ny_i+(n-m)(\hat\lambda^{(i)})}{n}\]</span></p>
<p><span class="math display">\[\lambda=\frac{\sum_{i=1}^ny_i+(n-m)\lambda}{n}\]</span> <span class="math display">\[\lambda=\frac{\sum_{i=1}^ny_i}{m}\]</span></p>
<p><span class="math display">\[l=\frac{1}{\lambda^m}\exp(-\frac{\sum x}{\lambda})\exp(-\frac{(n-m)\tau}{\lambda})\]</span> <span class="math display">\[\log(l)=-m\log(\lambda)-\frac{\sum x}{\lambda}-\frac{(n-m)\tau}{\lambda}\]</span> <span class="math display">\[MLE=\frac{\sum_{i=1}^ny_i}{m}\]</span></p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" title="1">y&lt;-<span class="kw">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>,<span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.91</span>,<span class="dv">1</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>)</a>
<a class="sourceLine" id="cb210-2" title="2">e=y[<span class="kw">which</span>(y[]<span class="op">!=</span><span class="dv">1</span>)]</a>
<a class="sourceLine" id="cb210-3" title="3">m&lt;-<span class="kw">length</span>(e)</a>
<a class="sourceLine" id="cb210-4" title="4">tau&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb210-5" title="5">ml&lt;-<span class="cf">function</span>(<span class="dt">lam=</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb210-6" title="6">  <span class="kw">return</span>(m<span class="op">*</span><span class="kw">log</span>(lam)<span class="op">+</span></a>
<a class="sourceLine" id="cb210-7" title="7"><span class="st">           </span><span class="kw">sum</span>(y)<span class="op">/</span>lam)</a>
<a class="sourceLine" id="cb210-8" title="8">}</a>
<a class="sourceLine" id="cb210-9" title="9"><span class="kw">sum</span>(y)<span class="op">/</span>m</a></code></pre></div>
<pre><code>## [1] 0.9642857</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" title="1"><span class="kw">library</span>(stats4)</a>
<a class="sourceLine" id="cb212-2" title="2">fiy&lt;-<span class="kw">mle</span>(ml)</a>
<a class="sourceLine" id="cb212-3" title="3">fiy<span class="op">@</span>coef</a></code></pre></div>
<pre><code>##       lam 
## 0.9642705</code></pre>
</div>
<div id="p204-1" class="section level1">
<h1>P204 1</h1>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" title="1"><span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb214-2" title="2">trims &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb214-3" title="3">x &lt;-<span class="st"> </span><span class="kw">rcauchy</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb214-4" title="4"><span class="kw">sum</span>(x)</a></code></pre></div>
<pre><code>## [1] 261.4189</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" title="1"><span class="kw">median</span>(x)</a></code></pre></div>
<pre><code>## [1] 0.1303608</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb218-1" title="1"><span class="kw">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="kw">mean</span>(x, <span class="dt">trim =</span> trim))</a></code></pre></div>
<pre><code>## [[1]]
## [1] 2.614189
## 
## [[2]]
## [1] 0.3893497
## 
## [[3]]
## [1] 0.2359156
## 
## [[4]]
## [1] 0.1303608</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb220-1" title="1"><span class="kw">lapply</span>(trims, mean, <span class="dt">x =</span> x)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 2.614189
## 
## [[2]]
## [1] 0.3893497
## 
## [[3]]
## [1] 0.2359156
## 
## [[4]]
## [1] 0.1303608</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb222-1" title="1"><span class="kw">lapply</span>(trims, sum, <span class="dt">x =</span> x)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 261.4189
## 
## [[2]]
## [1] 261.5189
## 
## [[3]]
## [1] 261.6189
## 
## [[4]]
## [1] 261.9189</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" title="1"><span class="kw">lapply</span>(trims, quantile, <span class="dt">x =</span> x)</a></code></pre></div>
<pre><code>## [[1]]
##        0% 
## -17.06245 
## 
## [[2]]
##       10% 
## -1.821155 
## 
## [[3]]
##        20% 
## -0.9887048 
## 
## [[4]]
##       50% 
## 0.1303608</code></pre>
</div>
<div id="p204-5" class="section level1">
<h1>P204 5</h1>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" title="1"><span class="kw">set.seed</span>(<span class="dv">20211126</span>)</a>
<a class="sourceLine" id="cb226-2" title="2"><span class="kw">data</span>(mtcars)</a>
<a class="sourceLine" id="cb226-3" title="3"></a>
<a class="sourceLine" id="cb226-4" title="4">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb226-5" title="5">mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb226-6" title="6">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb226-7" title="7">mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb226-8" title="8">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb226-9" title="9">)</a>
<a class="sourceLine" id="cb226-10" title="10">form&lt;-<span class="kw">lapply</span>(formulas,<span class="cf">function</span>(formula) <span class="kw">lm</span>(formula,<span class="dt">data =</span> mtcars))</a>
<a class="sourceLine" id="cb226-11" title="11"></a>
<a class="sourceLine" id="cb226-12" title="12">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb226-13" title="13">rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb226-14" title="14">mtcars[rows, ]})</a>
<a class="sourceLine" id="cb226-15" title="15"></a>
<a class="sourceLine" id="cb226-16" title="16">formulas2&lt;-<span class="kw">list</span>(mpg<span class="op">~</span>disp)</a>
<a class="sourceLine" id="cb226-17" title="17">lmb&lt;-<span class="kw">list</span>()</a>
<a class="sourceLine" id="cb226-18" title="18"><span class="kw">suppressWarnings</span>(</a>
<a class="sourceLine" id="cb226-19" title="19"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb226-20" title="20">  lmb[i]&lt;-<span class="kw">lapply</span>(formulas2,<span class="cf">function</span>(formula) <span class="kw">lm</span>(formula,<span class="dt">data =</span> bootstraps[[i]]))</a>
<a class="sourceLine" id="cb226-21" title="21">}</a>
<a class="sourceLine" id="cb226-22" title="22">)</a>
<a class="sourceLine" id="cb226-23" title="23">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb226-24" title="24">a&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb226-25" title="25">b&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb226-26" title="26"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) a[i]&lt;-<span class="kw">rsq</span>(form[[i]])</a>
<a class="sourceLine" id="cb226-27" title="27"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) b[i]&lt;-<span class="kw">rsq</span>(lmb[[i]])</a>
<a class="sourceLine" id="cb226-28" title="28">a</a></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" title="1">b</a></code></pre></div>
<pre><code>##  [1] 0.7980689 0.7357700 0.7850282 0.6320219 0.6045890 0.6924065 0.8190972
##  [8] 0.7348505 0.8435835 0.8141415</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" title="1"><span class="kw">mean</span>(b)</a></code></pre></div>
<pre><code>## [1] 0.7459557</code></pre>
</div>
<div id="p214-1" class="section level1">
<h1>P214 1</h1>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" title="1"><span class="kw">vapply</span>(mtcars,sd,<span class="kw">numeric</span>(<span class="dv">1</span>))</a></code></pre></div>
<pre><code>##         mpg         cyl        disp          hp        drat          wt 
##   6.0269481   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574 
##        qsec          vs          am        gear        carb 
##   1.7869432   0.5040161   0.4989909   0.7378041   1.6152000</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" title="1">mt&lt;-mtcars</a>
<a class="sourceLine" id="cb234-2" title="2">mt[,<span class="st">&quot;mpg&quot;</span>]&lt;-<span class="kw">as.character</span>(mt[,<span class="st">&quot;mpg&quot;</span>])</a>
<a class="sourceLine" id="cb234-3" title="3">mt[,<span class="st">&quot;mpg&quot;</span>]&lt;-<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>)</a>
<a class="sourceLine" id="cb234-4" title="4">mt</a></code></pre></div>
<pre><code>##                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4             a   6 160.0 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag         a   6 160.0 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710            a   4 108.0  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive        a   6 258.0 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout     a   8 360.0 175 3.15 3.440 17.02  0  0    3    2
## Valiant               a   6 225.0 105 2.76 3.460 20.22  1  0    3    1
## Duster 360            a   8 360.0 245 3.21 3.570 15.84  0  0    3    4
## Merc 240D             a   4 146.7  62 3.69 3.190 20.00  1  0    4    2
## Merc 230              a   4 140.8  95 3.92 3.150 22.90  1  0    4    2
## Merc 280              a   6 167.6 123 3.92 3.440 18.30  1  0    4    4
## Merc 280C             a   6 167.6 123 3.92 3.440 18.90  1  0    4    4
## Merc 450SE            a   8 275.8 180 3.07 4.070 17.40  0  0    3    3
## Merc 450SL            a   8 275.8 180 3.07 3.730 17.60  0  0    3    3
## Merc 450SLC           a   8 275.8 180 3.07 3.780 18.00  0  0    3    3
## Cadillac Fleetwood    a   8 472.0 205 2.93 5.250 17.98  0  0    3    4
## Lincoln Continental   a   8 460.0 215 3.00 5.424 17.82  0  0    3    4
## Chrysler Imperial     a   8 440.0 230 3.23 5.345 17.42  0  0    3    4
## Fiat 128              a   4  78.7  66 4.08 2.200 19.47  1  1    4    1
## Honda Civic           a   4  75.7  52 4.93 1.615 18.52  1  1    4    2
## Toyota Corolla        a   4  71.1  65 4.22 1.835 19.90  1  1    4    1
## Toyota Corona         a   4 120.1  97 3.70 2.465 20.01  1  0    3    1
## Dodge Challenger      a   8 318.0 150 2.76 3.520 16.87  0  0    3    2
## AMC Javelin           a   8 304.0 150 3.15 3.435 17.30  0  0    3    2
## Camaro Z28            a   8 350.0 245 3.73 3.840 15.41  0  0    3    4
## Pontiac Firebird      a   8 400.0 175 3.08 3.845 17.05  0  0    3    2
## Fiat X1-9             a   4  79.0  66 4.08 1.935 18.90  1  1    4    1
## Porsche 914-2         a   4 120.3  91 4.43 2.140 16.70  0  1    5    2
## Lotus Europa          a   4  95.1 113 3.77 1.513 16.90  1  1    5    2
## Ford Pantera L        a   8 351.0 264 4.22 3.170 14.50  0  1    5    4
## Ferrari Dino          a   6 145.0 175 3.62 2.770 15.50  0  1    5    6
## Maserati Bora         a   8 301.0 335 3.54 3.570 14.60  0  1    5    8
## Volvo 142E            a   4 121.0 109 4.11 2.780 18.60  1  1    4    2</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb236-1" title="1"><span class="kw">vapply</span>(mt[,<span class="kw">which</span>(<span class="kw">vapply</span>(mt,is.numeric,<span class="kw">logical</span>(<span class="dv">1</span>))<span class="op">==</span><span class="ot">TRUE</span>)],sd,<span class="kw">numeric</span>(<span class="dv">1</span>))</a></code></pre></div>
<pre><code>##         cyl        disp          hp        drat          wt        qsec 
##   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574   1.7869432 
##          vs          am        gear        carb 
##   0.5040161   0.4989909   0.7378041   1.6152000</code></pre>
</div>
<div id="p214-7" class="section level1">
<h1>P214 7</h1>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb238-1" title="1">mcsapply&lt;-<span class="cf">function</span>(x,a){</a>
<a class="sourceLine" id="cb238-2" title="2"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb238-3" title="3">cores &lt;-<span class="st"> </span><span class="kw">detectCores</span>()</a>
<a class="sourceLine" id="cb238-4" title="4">cluster &lt;-<span class="st"> </span><span class="kw">makePSOCKcluster</span>(cores)</a>
<a class="sourceLine" id="cb238-5" title="5">c&lt;-<span class="kw">unlist</span>(<span class="kw">parLapply</span>(cluster, x, a))</a>
<a class="sourceLine" id="cb238-6" title="6"><span class="kw">return</span>(c)</a>
<a class="sourceLine" id="cb238-7" title="7">}</a>
<a class="sourceLine" id="cb238-8" title="8">mcvapply&lt;-<span class="cf">function</span>(x,a,ty){</a>
<a class="sourceLine" id="cb238-9" title="9"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb238-10" title="10">cores &lt;-<span class="st"> </span><span class="kw">detectCores</span>()</a>
<a class="sourceLine" id="cb238-11" title="11">cluster &lt;-<span class="st"> </span><span class="kw">makePSOCKcluster</span>(cores)</a>
<a class="sourceLine" id="cb238-12" title="12">c&lt;-<span class="kw">unlist</span>(<span class="kw">parLapply</span>(cluster, x, a))</a>
<a class="sourceLine" id="cb238-13" title="13"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(c)){</a>
<a class="sourceLine" id="cb238-14" title="14">  <span class="cf">if</span>(<span class="kw">class</span>(c[i])<span class="op">==</span><span class="kw">class</span>(ty[i])) c[i]&lt;-c[i]</a>
<a class="sourceLine" id="cb238-15" title="15">    <span class="cf">else</span> {c[i]&lt;-<span class="kw">as.logical</span>(c[i]);c[i]=<span class="ot">FALSE</span>}</a>
<a class="sourceLine" id="cb238-16" title="16">}</a>
<a class="sourceLine" id="cb238-17" title="17"><span class="kw">return</span>(c)</a>
<a class="sourceLine" id="cb238-18" title="18">}</a>
<a class="sourceLine" id="cb238-19" title="19">a&lt;-<span class="cf">function</span>(x) x<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="kw">exp</span>(x)</a>
<a class="sourceLine" id="cb238-20" title="20">x&lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb238-21" title="21"><span class="kw">system.time</span>(<span class="kw">mcsapply</span>(x,a))</a></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.01 0.12 0.78</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb240-1" title="1"><span class="kw">system.time</span>(<span class="kw">sapply</span>(x,a))</a></code></pre></div>
<pre><code>## 用户 系统 流逝 
##    0    0    0</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb242-1" title="1"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb242-2" title="2">cl=<span class="kw">makeCluster</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb242-3" title="3"><span class="kw">system.time</span>(<span class="kw">parSapply</span>(cl,x,<span class="dt">FUN=</span><span class="cf">function</span>(x) x<span class="op">^</span><span class="dv">2</span>))</a></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.00 0.00 0.01</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb244-1" title="1"><span class="kw">stopCluster</span>(cl)</a>
<a class="sourceLine" id="cb244-2" title="2"></a>
<a class="sourceLine" id="cb244-3" title="3">b&lt;-<span class="kw">numeric</span>(<span class="dt">length =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb244-4" title="4"><span class="kw">mcvapply</span>(x,a,b)</a></code></pre></div>
<pre><code>##  [1]     3.718282    11.389056    29.085537    70.598150   173.413159
##  [6]   439.428793  1145.633158  3044.957987  8184.083928 22126.465795</code></pre>
</div>
<div id="section-15" class="section level1">
<h1>9.8</h1>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb246-1" title="1">gibbsR &lt;-<span class="st"> </span><span class="cf">function</span>(N,a,b,n) {</a>
<a class="sourceLine" id="cb246-2" title="2">  mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> N, <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb246-3" title="3">  x &lt;-<span class="st"> </span>y &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb246-4" title="4">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb246-5" title="5">    x&lt;-<span class="kw">rbinom</span>(<span class="dv">1</span>,n,y)</a>
<a class="sourceLine" id="cb246-6" title="6">    y&lt;-<span class="kw">rbeta</span>(<span class="dv">1</span>,x<span class="op">+</span>a,n<span class="op">-</span>x<span class="op">+</span>b)</a>
<a class="sourceLine" id="cb246-7" title="7">    mat[i, ] &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</a>
<a class="sourceLine" id="cb246-8" title="8">  }</a>
<a class="sourceLine" id="cb246-9" title="9">  mat</a>
<a class="sourceLine" id="cb246-10" title="10">}</a></code></pre></div>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb247-1" title="1"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb247-2" title="2">dir_cpp &lt;-<span class="st"> &#39;H:/Rp/StatComp21058/src/&#39;</span></a>
<a class="sourceLine" id="cb247-3" title="3"><span class="kw">sourceCpp</span>(<span class="kw">paste0</span>(dir_cpp,<span class="st">&quot;gibbsC.cpp&quot;</span>))</a></code></pre></div>
<pre><code>## Warning in normalizePath(path.expand(path), winslash, mustWork): path[1]=&quot;H:/Rp/
## StatComp21058/src/../inst/include&quot;: 系统找不到指定的路径。</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb249-1" title="1">N&lt;-<span class="dv">5000</span></a>
<a class="sourceLine" id="cb249-2" title="2">X1&lt;-X2&lt;-<span class="kw">matrix</span>(<span class="dt">nrow =</span> N, <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb249-3" title="3">X1&lt;-<span class="kw">gibbsC</span>(N,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb249-4" title="4">X2&lt;-<span class="kw">gibbsR</span>(N,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb249-5" title="5"><span class="kw">qqplot</span>(X1[,<span class="dv">1</span>],X2[,<span class="dv">1</span>],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb250-1" title="1"><span class="kw">qqplot</span>(X1[,<span class="dv">2</span>],X2[,<span class="dv">2</span>],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb251-1" title="1"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb251-2" title="2">t&lt;-<span class="kw">microbenchmark</span>(X1&lt;-<span class="kw">gibbsC</span>(N,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">10</span>),X2&lt;-<span class="kw">gibbsR</span>(N,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb251-3" title="3">t</a></code></pre></div>
<pre><code>## Unit: milliseconds
##                          expr      min        lq      mean    median        uq
##  X1 &lt;- gibbsC(N, 2, 2, 4, 10)  3.28789  3.631776  4.035316  3.818488  4.146512
##     X2 &lt;- gibbsR(N, 2, 4, 10) 21.16269 26.271021 31.862548 31.447915 35.457492
##        max neval
##   8.188726   100
##  50.358018   100</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
